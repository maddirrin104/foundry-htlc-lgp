# HTLC
```bash 
[*] start anvil...

==================== Deploy MockToken + HTLC_TRAD bằng forge script ====================

[*] ADDR_TOKEN_TRAD = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_TRAD  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0xee75d3900cc895a480a24a788ae08ef38d3d863e8c4a2e18b489738e7c4a3ade
blockNumber          7
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    458214714
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xee75d3900cc895a480a24a788ae08ef38d3d863e8c4a2e18b489738e7c4a3ade","blockNumber":"0x7","blockTimestamp":"0x692800c4","transactionHash":"0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE      = super-secret-preimage
[*] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] LOCK_ID_A     = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] LOCK_ID_B     = 0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551

==================== Approve token cho HTLC_TRAD ====================


blockHash            0xb2c3382ed6398c9742d40a13c2bfd832536bae37fb34e77a603b5542f0550223
blockNumber          8
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    401211433
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xb2c3382ed6398c9742d40a13c2bfd832536bae37fb34e77a603b5542f0550223","blockNumber":"0x8","blockTimestamp":"0x692800c5","transactionHash":"0xb6980a0180f5f76f0c778cecd38851afe0e963a0f22571ef28bac46dbbe00ad8","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xb6980a0180f5f76f0c778cecd38851afe0e963a0f22571ef28bac46dbbe00ad8
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario A – honest lock + claim sớm ====================

[*] Lock...

blockHash            0x3546338a697d6b210957c34d1afa46f6a8eecf7774c5f71e348c7a6f0cd60d69
blockNumber          9
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    351222398
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x3546338a697d6b210957c34d1afa46f6a8eecf7774c5f71e348c7a6f0cd60d69","blockNumber":"0x9","blockTimestamp":"0x692800c6","transactionHash":"0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x3546338a697d6b210957c34d1afa46f6a8eecf7774c5f71e348c7a6f0cd60d69","blockNumber":"0x9","blockTimestamp":"0x692800c6","transactionHash":"0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000002000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.036s
user    0m0.018s
sys     0m0.037s
[*] Claim sớm (trước timelock)...

blockHash            0x7ae8c8ee67860acee87bd4ca73023b244f0b8bf8659263d650ef561fb482c54e
blockNumber          10
contractAddress      
cumulativeGasUsed    90375
effectiveGasPrice    307896695
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              90375
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x7ae8c8ee67860acee87bd4ca73023b244f0b8bf8659263d650ef561fb482c54e","blockNumber":"0xa","blockTimestamp":"0x692800c7","transactionHash":"0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x809adb2ac2c2d26009bf1cdbc8de91bf56d1b0b7287e234c536d48220614dfc2","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8"],"data":"0x","blockHash":"0x7ae8c8ee67860acee87bd4ca73023b244f0b8bf8659263d650ef561fb482c54e","blockNumber":"0xa","blockTimestamp":"0x692800c7","transactionHash":"0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000008000000000000000000000000010000000000000000000000000010000000000000000000000000000000000000000000000000000008000000002000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000002000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.015s
sys     0m0.040s
[*] Balance receiver sau claim:
100000000000000000000 [1e20]

==================== Scenario B/C – lock, receiver im lặng, sender refund sau timelock ====================

[*] Lock lần 2 (dùng LOCK_ID_B)...

blockHash            0x97ba64c9d853c3806527ac60df017a41cc719963226ba1b67319700c259bc06e
blockNumber          11
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    269641493
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x97ba64c9d853c3806527ac60df017a41cc719963226ba1b67319700c259bc06e","blockNumber":"0xb","blockTimestamp":"0x692800c8","transactionHash":"0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x97ba64c9d853c3806527ac60df017a41cc719963226ba1b67319700c259bc06e","blockNumber":"0xb","blockTimestamp":"0x692800c8","transactionHash":"0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000000000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.786s
user    0m0.009s
sys     0m0.054s
[*] Timestamp hiện tại:
timestamp            1764229320 (Thu, 27 Nov 2025 07:42:00 +0000)
[*] Receiver KHÔNG claim → mô phỏng griefing.
[*] Tăng thời gian qua timelock = 1800 s...
1801
"0x0"
[*] Timestamp sau evm_increaseTime + evm_mine:
timestamp            1764231121 (Thu, 27 Nov 2025 08:12:01 +0000)
[*] Sender refund sau khi timelock qua...

blockHash            0xf6837bbb2cb44c318284a7a147005bcd061418dcd0e55e3c810b080c781b29f8
blockNumber          13
contractAddress      
cumulativeGasUsed    71794
effectiveGasPrice    206831938
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              71794
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xf6837bbb2cb44c318284a7a147005bcd061418dcd0e55e3c810b080c781b29f8","blockNumber":"0xd","blockTimestamp":"0x692807d2","transactionHash":"0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x88742b6d1d17c1f55e171a4a271ab897edfca6911cdcd6a4beecd9fbe8696609","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551"],"data":"0x","blockHash":"0xf6837bbb2cb44c318284a7a147005bcd061418dcd0e55e3c810b080c781b29f8","blockNumber":"0xd","blockTimestamp":"0x692807d2","transactionHash":"0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000408000000000000840000000000000000000000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000020000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.039s
user    0m0.018s
sys     0m0.051s
[*] Balance sender sau refund:
900000000000000000000 [9e20]

==> Run này dùng cho Scenario B (lock + refund) + Scenario C (griefing).

==================== Hoàn tất PoC HTLC truyền thống – Scenario A + B/C ====================
```
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC_TRAD bằng forge script ====================

[*] ADDR_TOKEN_TRAD = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_TRAD  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0x01652cbc9d063b05f949a1ca99ef0813c2c748e1893618e71b284b23f404ed5a
blockNumber          7
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    458214714
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x01652cbc9d063b05f949a1ca99ef0813c2c748e1893618e71b284b23f404ed5a","blockNumber":"0x7","blockTimestamp":"0x69280233","transactionHash":"0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE      = super-secret-preimage
[*] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] LOCK_ID_A     = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] LOCK_ID_B     = 0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551

==================== Approve token cho HTLC_TRAD ====================


blockHash            0xdc5b44149cb1692740fff7d29ad1d55ee0578576b228b446cf00fdbfba4d9c0a
blockNumber          8
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    401211433
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xdc5b44149cb1692740fff7d29ad1d55ee0578576b228b446cf00fdbfba4d9c0a","blockNumber":"0x8","blockTimestamp":"0x69280234","transactionHash":"0xb6980a0180f5f76f0c778cecd38851afe0e963a0f22571ef28bac46dbbe00ad8","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xb6980a0180f5f76f0c778cecd38851afe0e963a0f22571ef28bac46dbbe00ad8
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario A – honest lock + claim sớm ====================

[*] Lock...

blockHash            0xb42ec26add4d4372c6c8b3727fa2ae9e22a74595d756a6572ac1c6f6e8967149
blockNumber          9
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    351222398
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xb42ec26add4d4372c6c8b3727fa2ae9e22a74595d756a6572ac1c6f6e8967149","blockNumber":"0x9","blockTimestamp":"0x69280235","transactionHash":"0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xb42ec26add4d4372c6c8b3727fa2ae9e22a74595d756a6572ac1c6f6e8967149","blockNumber":"0x9","blockTimestamp":"0x69280235","transactionHash":"0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000002000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.793s
user    0m0.012s
sys     0m0.063s
[*] Claim sớm (trước timelock)...

blockHash            0x13df9809c2c886dd5b630b33ab22247010f05817d5884836d935d03108e22f87
blockNumber          10
contractAddress      
cumulativeGasUsed    90375
effectiveGasPrice    307896695
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              90375
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x13df9809c2c886dd5b630b33ab22247010f05817d5884836d935d03108e22f87","blockNumber":"0xa","blockTimestamp":"0x69280236","transactionHash":"0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x809adb2ac2c2d26009bf1cdbc8de91bf56d1b0b7287e234c536d48220614dfc2","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8"],"data":"0x","blockHash":"0x13df9809c2c886dd5b630b33ab22247010f05817d5884836d935d03108e22f87","blockNumber":"0xa","blockTimestamp":"0x69280236","transactionHash":"0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000008000000000000000000000000010000000000000000000000000010000000000000000000000000000000000000000000000000000008000000002000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000002000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.035s
user    0m0.004s
sys     0m0.057s
[*] Balance receiver sau claim:
100000000000000000000 [1e20]

==================== Scenario B/C – lock, receiver im lặng, sender refund sau timelock ====================

[*] Lock lần 2 (dùng LOCK_ID_B)...

blockHash            0x350da3094cb95d761d0958c48517d4841758a25c5a08771d00d2301b02281eaa
blockNumber          11
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    269641493
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x350da3094cb95d761d0958c48517d4841758a25c5a08771d00d2301b02281eaa","blockNumber":"0xb","blockTimestamp":"0x69280237","transactionHash":"0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x350da3094cb95d761d0958c48517d4841758a25c5a08771d00d2301b02281eaa","blockNumber":"0xb","blockTimestamp":"0x69280237","transactionHash":"0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000000000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.041s
user    0m0.014s
sys     0m0.051s
[*] Timestamp hiện tại:
timestamp            1764229687 (Thu, 27 Nov 2025 07:48:07 +0000)
[*] Receiver KHÔNG claim → mô phỏng griefing.
[*] Tăng thời gian qua timelock = 1800 s...
1801
"0x0"
[*] Timestamp sau evm_increaseTime + evm_mine:
timestamp            1764231488 (Thu, 27 Nov 2025 08:18:08 +0000)
[*] Sender refund sau khi timelock qua...

blockHash            0xa60a5e546307bfb4fc84e0d585319758d4f7fb889ac8b7ed3b60bc59df95fb6e
blockNumber          13
contractAddress      
cumulativeGasUsed    71794
effectiveGasPrice    206831938
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              71794
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xa60a5e546307bfb4fc84e0d585319758d4f7fb889ac8b7ed3b60bc59df95fb6e","blockNumber":"0xd","blockTimestamp":"0x69280941","transactionHash":"0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x88742b6d1d17c1f55e171a4a271ab897edfca6911cdcd6a4beecd9fbe8696609","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551"],"data":"0x","blockHash":"0xa60a5e546307bfb4fc84e0d585319758d4f7fb889ac8b7ed3b60bc59df95fb6e","blockNumber":"0xd","blockTimestamp":"0x69280941","transactionHash":"0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000408000000000000840000000000000000000000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000020000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.785s
user    0m0.010s
sys     0m0.049s
[*] Balance sender sau refund:
900000000000000000000 [9e20]

==> Run này dùng cho Scenario B (lock + refund) + Scenario C (griefing).

==================== Hoàn tất PoC HTLC truyền thống – Scenario A + B/C ====================
```
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC_TRAD bằng forge script ====================

[*] ADDR_TOKEN_TRAD = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_TRAD  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0xee88067e29e6fceb2b1f8787283f34b055ab38516df43cd8a26d8443aaaccdfc
blockNumber          6
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    523673958
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xee88067e29e6fceb2b1f8787283f34b055ab38516df43cd8a26d8443aaaccdfc","blockNumber":"0x6","blockTimestamp":"0x692802a6","transactionHash":"0x210dbe5722fadbc61c0181ca92ea6eb1153ccecb9b2a1b1fc6c0cf30dcf3d15f","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x210dbe5722fadbc61c0181ca92ea6eb1153ccecb9b2a1b1fc6c0cf30dcf3d15f
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE      = super-secret-preimage
[*] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] LOCK_ID_A     = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] LOCK_ID_B     = 0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551

==================== Approve token cho HTLC_TRAD ====================


blockHash            0xdc99456750148b875b69e869ceee3cf5fe22896920959ba10ebabe11f63f117e
blockNumber          7
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    458527352
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xdc99456750148b875b69e869ceee3cf5fe22896920959ba10ebabe11f63f117e","blockNumber":"0x7","blockTimestamp":"0x692802aa","transactionHash":"0x4f0c38506d10d4b19ff54a9f312ae508f3f7a2d930b2e4827ff5d3b8fdcb4fd2","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x4f0c38506d10d4b19ff54a9f312ae508f3f7a2d930b2e4827ff5d3b8fdcb4fd2
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario A – honest lock + claim sớm ====================

[*] Lock...

blockHash            0x9a153a98ae2bf85dba07cbc8784fc1080e9113404c606ed34539de8528bacd10
blockNumber          8
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    401397026
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x9a153a98ae2bf85dba07cbc8784fc1080e9113404c606ed34539de8528bacd10","blockNumber":"0x8","blockTimestamp":"0x692802ab","transactionHash":"0x77bb5140fd57e98cbc73e41c3a4418c786949f9789c4a4cc963e836b99ccc2bb","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x9a153a98ae2bf85dba07cbc8784fc1080e9113404c606ed34539de8528bacd10","blockNumber":"0x8","blockTimestamp":"0x692802ab","transactionHash":"0x77bb5140fd57e98cbc73e41c3a4418c786949f9789c4a4cc963e836b99ccc2bb","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000002000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x77bb5140fd57e98cbc73e41c3a4418c786949f9789c4a4cc963e836b99ccc2bb
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.789s
user    0m0.017s
sys     0m0.054s
[*] Claim sớm (trước timelock)...

blockHash            0x8d8af7a131c4ad4b0050ae98df0c4c16625ec36de42ff53898de669c701a7f09
blockNumber          9
contractAddress      
cumulativeGasUsed    90375
effectiveGasPrice    351881937
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              90375
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x8d8af7a131c4ad4b0050ae98df0c4c16625ec36de42ff53898de669c701a7f09","blockNumber":"0x9","blockTimestamp":"0x692802ac","transactionHash":"0x5d62a91e0dfb58a7004393fe1424631a447b7093e7480a38fe7be76658edfc67","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x809adb2ac2c2d26009bf1cdbc8de91bf56d1b0b7287e234c536d48220614dfc2","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8"],"data":"0x","blockHash":"0x8d8af7a131c4ad4b0050ae98df0c4c16625ec36de42ff53898de669c701a7f09","blockNumber":"0x9","blockTimestamp":"0x692802ac","transactionHash":"0x5d62a91e0dfb58a7004393fe1424631a447b7093e7480a38fe7be76658edfc67","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000008000000000000000000000000010000000000000000000000000010000000000000000000000000000000000000000000000000000008000000002000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000002000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x5d62a91e0dfb58a7004393fe1424631a447b7093e7480a38fe7be76658edfc67
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.035s
user    0m0.009s
sys     0m0.049s
[*] Balance receiver sau claim:
100000000000000000000 [1e20]

==================== Scenario B/C – lock, receiver im lặng, sender refund sau timelock ====================

[*] Lock lần 2 (dùng LOCK_ID_B)...

blockHash            0xbb5eb96e3784aa7165177161a6083f1d9f2c9e26501ab40bf5b5273c288dcf43
blockNumber          10
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    308161707
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xbb5eb96e3784aa7165177161a6083f1d9f2c9e26501ab40bf5b5273c288dcf43","blockNumber":"0xa","blockTimestamp":"0x692802ad","transactionHash":"0x78f7727ffd8888a559b4a13af2f027f829e360481eb8edc47863748f87a6b541","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xbb5eb96e3784aa7165177161a6083f1d9f2c9e26501ab40bf5b5273c288dcf43","blockNumber":"0xa","blockTimestamp":"0x692802ad","transactionHash":"0x78f7727ffd8888a559b4a13af2f027f829e360481eb8edc47863748f87a6b541","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000000000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x78f7727ffd8888a559b4a13af2f027f829e360481eb8edc47863748f87a6b541
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.015s
sys     0m0.041s
[*] Timestamp hiện tại:
timestamp            1764229805 (Thu, 27 Nov 2025 07:50:05 +0000)
[*] Receiver KHÔNG claim → mô phỏng griefing.
[*] Tăng thời gian qua timelock = 1800 s...
1801
"0x0"
[*] Timestamp sau evm_increaseTime + evm_mine:
timestamp            1764231606 (Thu, 27 Nov 2025 08:20:06 +0000)
[*] Sender refund sau khi timelock qua...

blockHash            0x7f7dca2530812f487ed1a118637c565ae8590a8ca8fbe444bcdad4ea71840e12
blockNumber          12
contractAddress      
cumulativeGasUsed    71794
effectiveGasPrice    236379358
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              71794
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x7f7dca2530812f487ed1a118637c565ae8590a8ca8fbe444bcdad4ea71840e12","blockNumber":"0xc","blockTimestamp":"0x692809b7","transactionHash":"0x28a664aa9094a7959499c4a4549217404002b21b6d39f762e2d9fc854e3dcd60","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x88742b6d1d17c1f55e171a4a271ab897edfca6911cdcd6a4beecd9fbe8696609","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551"],"data":"0x","blockHash":"0x7f7dca2530812f487ed1a118637c565ae8590a8ca8fbe444bcdad4ea71840e12","blockNumber":"0xc","blockTimestamp":"0x692809b7","transactionHash":"0x28a664aa9094a7959499c4a4549217404002b21b6d39f762e2d9fc854e3dcd60","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000408000000000000840000000000000000000000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000020000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x28a664aa9094a7959499c4a4549217404002b21b6d39f762e2d9fc854e3dcd60
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.784s
user    0m0.008s
sys     0m0.049s
[*] Balance sender sau refund:
900000000000000000000 [9e20]

==> Run này dùng cho Scenario B (lock + refund) + Scenario C (griefing).

==================== Hoàn tất PoC HTLC truyền thống – Scenario A + B/C ====================
```
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC_TRAD bằng forge script ====================

[*] ADDR_TOKEN_TRAD = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_TRAD  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0x401fb1792f98ad702a30cfe4edbb9f289c8e8d0b68726a0ef93ffbdbcfab9381
blockNumber          7
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    458214714
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x401fb1792f98ad702a30cfe4edbb9f289c8e8d0b68726a0ef93ffbdbcfab9381","blockNumber":"0x7","blockTimestamp":"0x692802fd","transactionHash":"0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE      = super-secret-preimage
[*] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] LOCK_ID_A     = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] LOCK_ID_B     = 0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551

==================== Approve token cho HTLC_TRAD ====================


blockHash            0x0ad90e07b0eb11dd108eb65e58f6aec76ec62158a98a1f99deb5906501b4eecf
blockNumber          8
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    401211433
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x0ad90e07b0eb11dd108eb65e58f6aec76ec62158a98a1f99deb5906501b4eecf","blockNumber":"0x8","blockTimestamp":"0x692802fe","transactionHash":"0xb6980a0180f5f76f0c778cecd38851afe0e963a0f22571ef28bac46dbbe00ad8","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xb6980a0180f5f76f0c778cecd38851afe0e963a0f22571ef28bac46dbbe00ad8
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario A – honest lock + claim sớm ====================

[*] Lock...

blockHash            0x536abd623ddcb12128ecc49f69a40d7244a8ecd930256e1e6f2ca62ba4c88f47
blockNumber          9
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    351222398
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x536abd623ddcb12128ecc49f69a40d7244a8ecd930256e1e6f2ca62ba4c88f47","blockNumber":"0x9","blockTimestamp":"0x692802ff","transactionHash":"0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x536abd623ddcb12128ecc49f69a40d7244a8ecd930256e1e6f2ca62ba4c88f47","blockNumber":"0x9","blockTimestamp":"0x692802ff","transactionHash":"0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000002000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xed9f78ed769a880728a25a6f72e962485c0d2ca734c25362d824ef374ddb6b92
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.016s
sys     0m0.044s
[*] Claim sớm (trước timelock)...

blockHash            0x1d0e249b46be2e68a7a49ce7a19f26b3a212481846423ee1901a8f58a19fb513
blockNumber          10
contractAddress      
cumulativeGasUsed    90375
effectiveGasPrice    307896695
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              90375
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x1d0e249b46be2e68a7a49ce7a19f26b3a212481846423ee1901a8f58a19fb513","blockNumber":"0xa","blockTimestamp":"0x69280300","transactionHash":"0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x809adb2ac2c2d26009bf1cdbc8de91bf56d1b0b7287e234c536d48220614dfc2","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8"],"data":"0x","blockHash":"0x1d0e249b46be2e68a7a49ce7a19f26b3a212481846423ee1901a8f58a19fb513","blockNumber":"0xa","blockTimestamp":"0x69280300","transactionHash":"0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000008000000000000000000000000010000000000000000000000000010000000000000000000000000000000000000000000000000000008000000002000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000002000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xf7fae06f2cc2e6c0b8814d1024ac8133e06bef88296fb8272a9a764f93859a4b
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.035s
user    0m0.009s
sys     0m0.057s
[*] Balance receiver sau claim:
100000000000000000000 [1e20]

==================== Scenario B/C – lock, receiver im lặng, sender refund sau timelock ====================

[*] Lock lần 2 (dùng LOCK_ID_B)...

blockHash            0x2735e71a268d86c8fb4ed45aee1f8f2b1e4f79398c99fedd7616bc86a05628c3
blockNumber          11
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    269641493
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x2735e71a268d86c8fb4ed45aee1f8f2b1e4f79398c99fedd7616bc86a05628c3","blockNumber":"0xb","blockTimestamp":"0x69280301","transactionHash":"0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x2735e71a268d86c8fb4ed45aee1f8f2b1e4f79398c99fedd7616bc86a05628c3","blockNumber":"0xb","blockTimestamp":"0x69280301","transactionHash":"0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000000000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x0c9ed98a53d692cce1dace28af5ddffa320b23d44d42301fa64035061082ff58
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.032s
user    0m0.009s
sys     0m0.047s
[*] Timestamp hiện tại:
timestamp            1764229889 (Thu, 27 Nov 2025 07:51:29 +0000)
[*] Receiver KHÔNG claim → mô phỏng griefing.
[*] Tăng thời gian qua timelock = 1800 s...
1801
"0x0"
[*] Timestamp sau evm_increaseTime + evm_mine:
timestamp            1764231690 (Thu, 27 Nov 2025 08:21:30 +0000)
[*] Sender refund sau khi timelock qua...

blockHash            0xdde91ddfc4f68476a6c8e01b4f042070949e69c6fcea784df05527c30c4ae32a
blockNumber          13
contractAddress      
cumulativeGasUsed    71794
effectiveGasPrice    206831938
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              71794
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xdde91ddfc4f68476a6c8e01b4f042070949e69c6fcea784df05527c30c4ae32a","blockNumber":"0xd","blockTimestamp":"0x69280a0b","transactionHash":"0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x88742b6d1d17c1f55e171a4a271ab897edfca6911cdcd6a4beecd9fbe8696609","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551"],"data":"0x","blockHash":"0xdde91ddfc4f68476a6c8e01b4f042070949e69c6fcea784df05527c30c4ae32a","blockNumber":"0xd","blockTimestamp":"0x69280a0b","transactionHash":"0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000408000000000000840000000000000000000000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000020000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xc624120dc4228d3bf743ba7a6de542a95156709aa390fba115402ca65ff343e1
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.781s
user    0m0.013s
sys     0m0.045s
[*] Balance sender sau refund:
900000000000000000000 [9e20]

==> Run này dùng cho Scenario B (lock + refund) + Scenario C (griefing).

==================== Hoàn tất PoC HTLC truyền thống – Scenario A + B/C ====================
```
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC_TRAD bằng forge script ====================

[*] ADDR_TOKEN_TRAD = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_TRAD  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0x76b37c32b854a2abb3633d43627a5272f47bc8c84229a0b60dc366cc707a123d
blockNumber          6
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    523673958
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x76b37c32b854a2abb3633d43627a5272f47bc8c84229a0b60dc366cc707a123d","blockNumber":"0x6","blockTimestamp":"0x6928033a","transactionHash":"0x210dbe5722fadbc61c0181ca92ea6eb1153ccecb9b2a1b1fc6c0cf30dcf3d15f","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x210dbe5722fadbc61c0181ca92ea6eb1153ccecb9b2a1b1fc6c0cf30dcf3d15f
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE      = super-secret-preimage
[*] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] LOCK_ID_A     = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] LOCK_ID_B     = 0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551

==================== Approve token cho HTLC_TRAD ====================


blockHash            0x8c234b876ae5b0dbd5c130796fe5354f4950b0d7aa92ada93b85490a6448fce4
blockNumber          7
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    458527352
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x8c234b876ae5b0dbd5c130796fe5354f4950b0d7aa92ada93b85490a6448fce4","blockNumber":"0x7","blockTimestamp":"0x6928033b","transactionHash":"0x4f0c38506d10d4b19ff54a9f312ae508f3f7a2d930b2e4827ff5d3b8fdcb4fd2","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x4f0c38506d10d4b19ff54a9f312ae508f3f7a2d930b2e4827ff5d3b8fdcb4fd2
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario A – honest lock + claim sớm ====================

[*] Lock...

blockHash            0xa6ebc04fc533c4db869ef40bfcde5862089371e5f911721ed05a261b79ed3307
blockNumber          8
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    401397026
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xa6ebc04fc533c4db869ef40bfcde5862089371e5f911721ed05a261b79ed3307","blockNumber":"0x8","blockTimestamp":"0x6928033c","transactionHash":"0x77bb5140fd57e98cbc73e41c3a4418c786949f9789c4a4cc963e836b99ccc2bb","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xa6ebc04fc533c4db869ef40bfcde5862089371e5f911721ed05a261b79ed3307","blockNumber":"0x8","blockTimestamp":"0x6928033c","transactionHash":"0x77bb5140fd57e98cbc73e41c3a4418c786949f9789c4a4cc963e836b99ccc2bb","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000002000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x77bb5140fd57e98cbc73e41c3a4418c786949f9789c4a4cc963e836b99ccc2bb
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.033s
user    0m0.020s
sys     0m0.041s
[*] Claim sớm (trước timelock)...

blockHash            0x16827d85911f582101b7c191dd17ba5fa4a04fc2094672f09f799208a13d5032
blockNumber          9
contractAddress      
cumulativeGasUsed    90375
effectiveGasPrice    351881937
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              90375
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x16827d85911f582101b7c191dd17ba5fa4a04fc2094672f09f799208a13d5032","blockNumber":"0x9","blockTimestamp":"0x6928033d","transactionHash":"0x5d62a91e0dfb58a7004393fe1424631a447b7093e7480a38fe7be76658edfc67","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x809adb2ac2c2d26009bf1cdbc8de91bf56d1b0b7287e234c536d48220614dfc2","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8"],"data":"0x","blockHash":"0x16827d85911f582101b7c191dd17ba5fa4a04fc2094672f09f799208a13d5032","blockNumber":"0x9","blockTimestamp":"0x6928033d","transactionHash":"0x5d62a91e0dfb58a7004393fe1424631a447b7093e7480a38fe7be76658edfc67","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000008000000000000000000000000010000000000000000000000000010000000000000000000000000000000000000000000000000000008000000002000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000002000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x5d62a91e0dfb58a7004393fe1424631a447b7093e7480a38fe7be76658edfc67
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.032s
user    0m0.020s
sys     0m0.036s
[*] Balance receiver sau claim:
100000000000000000000 [1e20]

==================== Scenario B/C – lock, receiver im lặng, sender refund sau timelock ====================

[*] Lock lần 2 (dùng LOCK_ID_B)...

blockHash            0x6f9d6a03f859c32ec884129c39ff7df891fec8c7a8a82ae52d82f312484066ec
blockNumber          10
contractAddress      
cumulativeGasUsed    197173
effectiveGasPrice    308161707
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              197173
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x6f9d6a03f859c32ec884129c39ff7df891fec8c7a8a82ae52d82f312484066ec","blockNumber":"0xa","blockTimestamp":"0x6928033e","transactionHash":"0x78f7727ffd8888a559b4a13af2f027f829e360481eb8edc47863748f87a6b541","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc2dd01a86a5ce61ff91220fc5c6dd7194639809d3f90faa8d6220ef43ccdfdfb","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x6f9d6a03f859c32ec884129c39ff7df891fec8c7a8a82ae52d82f312484066ec","blockNumber":"0xa","blockTimestamp":"0x6928033e","transactionHash":"0x78f7727ffd8888a559b4a13af2f027f829e360481eb8edc47863748f87a6b541","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000400000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000008000000840000000000000000100000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000300000000000001000000000002000000000000000000000000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x78f7727ffd8888a559b4a13af2f027f829e360481eb8edc47863748f87a6b541
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.011s
sys     0m0.054s
[*] Timestamp hiện tại:
timestamp            1764229950 (Thu, 27 Nov 2025 07:52:30 +0000)
[*] Receiver KHÔNG claim → mô phỏng griefing.
[*] Tăng thời gian qua timelock = 1800 s...
1801
"0x0"
[*] Timestamp sau evm_increaseTime + evm_mine:
timestamp            1764231751 (Thu, 27 Nov 2025 08:22:31 +0000)
[*] Sender refund sau khi timelock qua...

blockHash            0xfd342a6bb4ce42ac646821646d9524306ac13aacc5345ca56dd1abad6f996245
blockNumber          12
contractAddress      
cumulativeGasUsed    71794
effectiveGasPrice    236379358
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              71794
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xfd342a6bb4ce42ac646821646d9524306ac13aacc5345ca56dd1abad6f996245","blockNumber":"0xc","blockTimestamp":"0x69280a48","transactionHash":"0x28a664aa9094a7959499c4a4549217404002b21b6d39f762e2d9fc854e3dcd60","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x88742b6d1d17c1f55e171a4a271ab897edfca6911cdcd6a4beecd9fbe8696609","0x1c9307f512dbbbe608473d226820e918fa0dadf7d4348319a4cd5e5526f01551"],"data":"0x","blockHash":"0xfd342a6bb4ce42ac646821646d9524306ac13aacc5345ca56dd1abad6f996245","blockNumber":"0xc","blockTimestamp":"0x69280a48","transactionHash":"0x28a664aa9094a7959499c4a4549217404002b21b6d39f762e2d9fc854e3dcd60","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000408000000000000840000000000000000000000000000000000040000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000020000000800002000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x28a664aa9094a7959499c4a4549217404002b21b6d39f762e2d9fc854e3dcd60
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.784s
user    0m0.007s
sys     0m0.051s
[*] Balance sender sau refund:
900000000000000000000 [9e20]

==> Run này dùng cho Scenario B (lock + refund) + Scenario C (griefing).

==================== Hoàn tất PoC HTLC truyền thống – Scenario A + B/C ====================
```

#HTLC-GP
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC-GP bằng forge script ====================

[*] ADDR_TOKEN_GP = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_GP  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0xfbb8d3c416a8354270cc656dde0830ffcf11a03d2eb993c369888ccd645f54d0
blockNumber          7
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    461509953
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xfbb8d3c416a8354270cc656dde0830ffcf11a03d2eb993c369888ccd645f54d0","blockNumber":"0x7","blockTimestamp":"0x692803bd","transactionHash":"0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE      = super-secret-preimage
[*] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] LOCK_ID_A     = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] LOCK_ID_B     = 0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a
[*] LOCK_ID_C     = 0x56f1f34a217edd60ed42a274fce63d527b2e80dd3646e2aebc54840de63d10d6

==================== Approve token cho HTLC-GP ====================


blockHash            0x28559f41a28bd7e967d3a0caa0e55cb5a4aa68a89ae1a59d48ef98c19f7ce97e
blockNumber          8
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    404096735
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x28559f41a28bd7e967d3a0caa0e55cb5a4aa68a89ae1a59d48ef98c19f7ce97e","blockNumber":"0x8","blockTimestamp":"0x692803be","transactionHash":"0x20be9f2f9ec9af8921d944a70e5a6fbece016cf8a795142cf6216103d937b143","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x20be9f2f9ec9af8921d944a70e5a6fbece016cf8a795142cf6216103d937b143
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario A – Honest: createLock + confirmParticipation + claim sớm ====================

[*] createLock...

blockHash            0x1d8a1982d111d8ea8dc44ba249cfa347b6d0fb1886bfc1e2a900fb6bd166817a
blockNumber          9
contractAddress      
cumulativeGasUsed    245868
effectiveGasPrice    353748205
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              245868
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x1d8a1982d111d8ea8dc44ba249cfa347b6d0fb1886bfc1e2a900fb6bd166817a","blockNumber":"0x9","blockTimestamp":"0x692803bf","transactionHash":"0xf7446e9c1f866dfa1509134ab0a2ea6a4f6cb043e8ba191d27da7040bb04b9b0","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x211974fc67bb5ea63cf9d02ac6890d8f1e32d01a4651fac202452bf74ca41297","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280ac70000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000069280617","blockHash":"0x1d8a1982d111d8ea8dc44ba249cfa347b6d0fb1886bfc1e2a900fb6bd166817a","blockNumber":"0x9","blockTimestamp":"0x692803bf","transactionHash":"0xf7446e9c1f866dfa1509134ab0a2ea6a4f6cb043e8ba191d27da7040bb04b9b0","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000020000000000000000000000008000000000000000000000000000000000000000000000840000080000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000004000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xf7446e9c1f866dfa1509134ab0a2ea6a4f6cb043e8ba191d27da7040bb04b9b0
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.008s
sys     0m0.050s
[*] confirmParticipation (deposit)...

blockHash            0x484dbff6655e1cca4763fadd49cb8ba586c856a918bf9a3ae754e1374d95b49e
blockNumber          10
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    310254475
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x484dbff6655e1cca4763fadd49cb8ba586c856a918bf9a3ae754e1374d95b49e","blockNumber":"0xa","blockTimestamp":"0x692803c0","transactionHash":"0x2d41d4244cd96b8217b751bbe20ce1c55d033b861d3061ed8a5731e63ac7a6f0","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x2d41d4244cd96b8217b751bbe20ce1c55d033b861d3061ed8a5731e63ac7a6f0
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.043s
user    0m0.015s
sys     0m0.085s
[*] claim sớm...

blockHash            0xbfa6d2945849cacdda5f8e972aa37378d18427aa5a973508cbc7dc1ac1ef79ff
blockNumber          11
contractAddress      
cumulativeGasUsed    89649
effectiveGasPrice    271688740
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              89649
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xbfa6d2945849cacdda5f8e972aa37378d18427aa5a973508cbc7dc1ac1ef79ff","blockNumber":"0xb","blockTimestamp":"0x692803c1","transactionHash":"0xc1e9cb41942280c2a950bb80221d7ef2f09cbc5ff17d20f603c5bb7c35292d64","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc59b252e4b6709d173cda0f28fc43c8141436808e4959fd5daa15810fc62f819","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x","blockHash":"0xbfa6d2945849cacdda5f8e972aa37378d18427aa5a973508cbc7dc1ac1ef79ff","blockNumber":"0xb","blockTimestamp":"0x692803c1","transactionHash":"0xc1e9cb41942280c2a950bb80221d7ef2f09cbc5ff17d20f603c5bb7c35292d64","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000008000000000000000000000000000000000000000000000000000010800000000000000000000000000000000000000000000000000008000000000000000000000000000020000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000004000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xc1e9cb41942280c2a950bb80221d7ef2f09cbc5ff17d20f603c5bb7c35292d64
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.005s
sys     0m0.051s
[*] Balance receiver sau claim (token):
100000000000000000000 [1e20]
[*] Balance receiver (ETH) – deposit đã refund:
99999916651444365692

==================== Scenario B – Griefing: receiver đã cọc nhưng im lặng, sender refund sau timelock ====================

[*] createLock (LOCK_ID_B)...

blockHash            0x988be8b4f65eb2d04ddfea97e40048cf9f4391e588a4bf6e99f1ea8f7aa7ac53
blockNumber          12
contractAddress      
cumulativeGasUsed    245868
effectiveGasPrice    237930620
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              245868
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x988be8b4f65eb2d04ddfea97e40048cf9f4391e588a4bf6e99f1ea8f7aa7ac53","blockNumber":"0xc","blockTimestamp":"0x692803c2","transactionHash":"0x69c85f9a9e51f7078fea47a954fa8f8b7807db863399d63f4627f895d0c4ee73","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x211974fc67bb5ea63cf9d02ac6890d8f1e32d01a4651fac202452bf74ca41297","0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280aca0000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000006928061a","blockHash":"0x988be8b4f65eb2d04ddfea97e40048cf9f4391e588a4bf6e99f1ea8f7aa7ac53","blockNumber":"0xc","blockTimestamp":"0x692803c2","transactionHash":"0x69c85f9a9e51f7078fea47a954fa8f8b7807db863399d63f4627f895d0c4ee73","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402004000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000020000000000000000000000028000000000000000000000000000000000000000000000840000080000000000100000000000000000000000000000014000000000000000020000000000000000000000000000000000000000004000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x69c85f9a9e51f7078fea47a954fa8f8b7807db863399d63f4627f895d0c4ee73
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.036s
user    0m0.021s
sys     0m0.040s
[*] confirmParticipation (deposit)...

blockHash            0xad51aa75d617d24440df5c77bdf7a26e83ec4b88ddaf5b6db67488a03e625832
blockNumber          13
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    208676789
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xad51aa75d617d24440df5c77bdf7a26e83ec4b88ddaf5b6db67488a03e625832","blockNumber":"0xd","blockTimestamp":"0x692803c3","transactionHash":"0xbc64e90e347e340ec026b1e9e8fc5f439487a0ea9fcfd8de6933c2aa4f76ebbb","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000120000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000020000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xbc64e90e347e340ec026b1e9e8fc5f439487a0ea9fcfd8de6933c2aa4f76ebbb
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.784s
user    0m0.005s
sys     0m0.054s
[*] Receiver KHÔNG claim → mô phỏng griefing.
[*] Tăng thời gian vượt TIMELOCK=1800 s...
1801
"0x0"
[*] Sender refund...

blockHash            0xa357cfb2851f4c0bc13e6de066d25f64a8c4539c7de05fa7e3e13756b15ef121
blockNumber          15
contractAddress      
cumulativeGasUsed    69408
effectiveGasPrice    159895332
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              69408
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xa357cfb2851f4c0bc13e6de066d25f64a8c4539c7de05fa7e3e13756b15ef121","blockNumber":"0xf","blockTimestamp":"0x69280acd","transactionHash":"0x2bde3d672f2b0aabf9c3e9e120e26bd3997f700ef9a3ed555491c2e5b149bd8e","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xa357cfb2851f4c0bc13e6de066d25f64a8c4539c7de05fa7e3e13756b15ef121","blockNumber":"0xf","blockTimestamp":"0x69280acd","transactionHash":"0x2bde3d672f2b0aabf9c3e9e120e26bd3997f700ef9a3ed555491c2e5b149bd8e","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402004000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000014000000000000000020004000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x2bde3d672f2b0aabf9c3e9e120e26bd3997f700ef9a3ed555491c2e5b149bd8e
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.032s
user    0m0.012s
sys     0m0.043s
[*] Balance sender (token) sau refund:
900000000000000000000 [9e20]
[*] Balance sender (ETH) – nhận thêm penalty ≈ depositRequired:
100999823799712935759

==================== Scenario C – Không confirm deposit, refund sau depositWindow, penalty = 0 ====================

[*] createLock (LOCK_ID_C) – KHÔNG confirmParticipation...

blockHash            0x322a6801ccfa6c193f09e41831b798bf30da775d142a7fe2b56a7229e9574f77
blockNumber          16
contractAddress      
cumulativeGasUsed    245868
effectiveGasPrice    140000900
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              245868
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x322a6801ccfa6c193f09e41831b798bf30da775d142a7fe2b56a7229e9574f77","blockNumber":"0x10","blockTimestamp":"0x69280ace","transactionHash":"0x82876b348a75309e315e2daec3966af4970730e5ecb765b57376fb0723287b77","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x211974fc67bb5ea63cf9d02ac6890d8f1e32d01a4651fac202452bf74ca41297","0x56f1f34a217edd60ed42a274fce63d527b2e80dd3646e2aebc54840de63d10d6","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d6310000000000000000000000000000000000000000000000000000000000000692811d60000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000069280d26","blockHash":"0x322a6801ccfa6c193f09e41831b798bf30da775d142a7fe2b56a7229e9574f77","blockNumber":"0x10","blockTimestamp":"0x69280ace","transactionHash":"0x82876b348a75309e315e2daec3966af4970730e5ecb765b57376fb0723287b77","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000020000000000000000000000008000000000000000000000000000000100000000000000840000080000000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000004000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000002000000000001000000000000800000000400000000
root                 
status               1 (success)
transactionHash      0x82876b348a75309e315e2daec3966af4970730e5ecb765b57376fb0723287b77
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.033s
user    0m0.016s
sys     0m0.039s
[*] Tăng thời gian qua depositWindow=600 s (nhưng có thể < timelock)...
2402
"0x0"
[*] Sender refund (nhánh !depositConfirmed)...

blockHash            0xc04366c2ee08e7897fde8dd90a03a2a07c0b68c51176fbbbf71d2b4ab497234d
blockNumber          18
contractAddress      
cumulativeGasUsed    77847
effectiveGasPrice    107439182
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              77847
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xc04366c2ee08e7897fde8dd90a03a2a07c0b68c51176fbbbf71d2b4ab497234d","blockNumber":"0x12","blockTimestamp":"0x69280d28","transactionHash":"0x9dcafb5e14fae5eecde2dfa576f6d1e53d4568222dca90bb3cde58a8c5e51bbc","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x56f1f34a217edd60ed42a274fce63d527b2e80dd3646e2aebc54840de63d10d6","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xc04366c2ee08e7897fde8dd90a03a2a07c0b68c51176fbbbf71d2b4ab497234d","blockNumber":"0x12","blockTimestamp":"0x69280d28","transactionHash":"0x9dcafb5e14fae5eecde2dfa576f6d1e53d4568222dca90bb3cde58a8c5e51bbc","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000100000000000000840000000000000000000000000000000000000000000000014000000000000000000004000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000002000000000001000000000000800000000400000000
root                 
status               1 (success)
transactionHash      0x9dcafb5e14fae5eecde2dfa576f6d1e53d4568222dca90bb3cde58a8c5e51bbc
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.783s
user    0m0.009s
sys     0m0.040s
[*] Balance sender (token) sau refund:
900000000000000000000 [9e20]
[*] Balance sender (ETH) – không có penalty vì depositPaid = 0:
100999781014153653405

==================== Hoàn tất PoC HTLC-GP – Scenario A + B + C ====================
```
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC-GP bằng forge script ====================

[*] ADDR_TOKEN_GP = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_GP  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0xd9929c52e42be55452ef7a2298a7951db2dccb702925da40f80d5c7e29d2dc1e
blockNumber          7
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    461509953
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xd9929c52e42be55452ef7a2298a7951db2dccb702925da40f80d5c7e29d2dc1e","blockNumber":"0x7","blockTimestamp":"0x692803ff","transactionHash":"0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE      = super-secret-preimage
[*] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] LOCK_ID_A     = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] LOCK_ID_B     = 0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a
[*] LOCK_ID_C     = 0x56f1f34a217edd60ed42a274fce63d527b2e80dd3646e2aebc54840de63d10d6

==================== Approve token cho HTLC-GP ====================


blockHash            0x66049948917ec9e1b86f68b99ce89f24fd0dcae6083dbd3f81c61e295f7b3fbc
blockNumber          8
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    404096735
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x66049948917ec9e1b86f68b99ce89f24fd0dcae6083dbd3f81c61e295f7b3fbc","blockNumber":"0x8","blockTimestamp":"0x69280402","transactionHash":"0x20be9f2f9ec9af8921d944a70e5a6fbece016cf8a795142cf6216103d937b143","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x20be9f2f9ec9af8921d944a70e5a6fbece016cf8a795142cf6216103d937b143
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario A – Honest: createLock + confirmParticipation + claim sớm ====================

[*] createLock...

blockHash            0xac2dc1b29d1eb732c6d2529ca2118e3d4e09979c1e6a39bbdda2da6e6bda5300
blockNumber          9
contractAddress      
cumulativeGasUsed    245868
effectiveGasPrice    353748205
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              245868
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xac2dc1b29d1eb732c6d2529ca2118e3d4e09979c1e6a39bbdda2da6e6bda5300","blockNumber":"0x9","blockTimestamp":"0x69280403","transactionHash":"0xf7446e9c1f866dfa1509134ab0a2ea6a4f6cb043e8ba191d27da7040bb04b9b0","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x211974fc67bb5ea63cf9d02ac6890d8f1e32d01a4651fac202452bf74ca41297","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280b0b0000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000006928065b","blockHash":"0xac2dc1b29d1eb732c6d2529ca2118e3d4e09979c1e6a39bbdda2da6e6bda5300","blockNumber":"0x9","blockTimestamp":"0x69280403","transactionHash":"0xf7446e9c1f866dfa1509134ab0a2ea6a4f6cb043e8ba191d27da7040bb04b9b0","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000020000000000000000000000008000000000000000000000000000000000000000000000840000080000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000004000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xf7446e9c1f866dfa1509134ab0a2ea6a4f6cb043e8ba191d27da7040bb04b9b0
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.050s
user    0m0.024s
sys     0m0.064s
[*] confirmParticipation (deposit)...

blockHash            0x31d29433043bd542a9097adced5fed972cae08b8a058b94f0cc405403a349878
blockNumber          10
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    310254475
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x31d29433043bd542a9097adced5fed972cae08b8a058b94f0cc405403a349878","blockNumber":"0xa","blockTimestamp":"0x69280404","transactionHash":"0x2d41d4244cd96b8217b751bbe20ce1c55d033b861d3061ed8a5731e63ac7a6f0","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x2d41d4244cd96b8217b751bbe20ce1c55d033b861d3061ed8a5731e63ac7a6f0
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.041s
user    0m0.009s
sys     0m0.061s
[*] claim sớm...

blockHash            0x99f71a04ac13e6a44b55a4608b94d1b1306bb11903c4904b496c01f2f47ef199
blockNumber          11
contractAddress      
cumulativeGasUsed    89649
effectiveGasPrice    271688740
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              89649
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x99f71a04ac13e6a44b55a4608b94d1b1306bb11903c4904b496c01f2f47ef199","blockNumber":"0xb","blockTimestamp":"0x69280405","transactionHash":"0xc1e9cb41942280c2a950bb80221d7ef2f09cbc5ff17d20f603c5bb7c35292d64","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0xc59b252e4b6709d173cda0f28fc43c8141436808e4959fd5daa15810fc62f819","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x","blockHash":"0x99f71a04ac13e6a44b55a4608b94d1b1306bb11903c4904b496c01f2f47ef199","blockNumber":"0xb","blockTimestamp":"0x69280405","transactionHash":"0xc1e9cb41942280c2a950bb80221d7ef2f09cbc5ff17d20f603c5bb7c35292d64","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000008000000000000000000000000000000000000000000000000000010800000000000000000000000000000000000000000000000000008000000000000000000000000000020000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000000020000000000000000000000000000000000200000000000000000000000004000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xc1e9cb41942280c2a950bb80221d7ef2f09cbc5ff17d20f603c5bb7c35292d64
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.795s
user    0m0.015s
sys     0m0.058s
[*] Balance receiver sau claim (token):
100000000000000000000 [1e20]
[*] Balance receiver (ETH) – deposit đã refund:
99999916651444365692

==================== Scenario B – Griefing: receiver đã cọc nhưng im lặng, sender refund sau timelock ====================

[*] createLock (LOCK_ID_B)...

blockHash            0x6de981556a56eeeb5acad911bed4231283092387fbd7b01a6b8b819abd1251fc
blockNumber          12
contractAddress      
cumulativeGasUsed    245868
effectiveGasPrice    237930620
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              245868
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x6de981556a56eeeb5acad911bed4231283092387fbd7b01a6b8b819abd1251fc","blockNumber":"0xc","blockTimestamp":"0x69280406","transactionHash":"0x69c85f9a9e51f7078fea47a954fa8f8b7807db863399d63f4627f895d0c4ee73","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x211974fc67bb5ea63cf9d02ac6890d8f1e32d01a4651fac202452bf74ca41297","0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280b0e0000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000006928065e","blockHash":"0x6de981556a56eeeb5acad911bed4231283092387fbd7b01a6b8b819abd1251fc","blockNumber":"0xc","blockTimestamp":"0x69280406","transactionHash":"0x69c85f9a9e51f7078fea47a954fa8f8b7807db863399d63f4627f895d0c4ee73","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402004000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000020000000000000000000000028000000000000000000000000000000000000000000000840000080000000000100000000000000000000000000000014000000000000000020000000000000000000000000000000000000000004000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x69c85f9a9e51f7078fea47a954fa8f8b7807db863399d63f4627f895d0c4ee73
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.044s
user    0m0.018s
sys     0m0.063s
[*] confirmParticipation (deposit)...

blockHash            0x29ca2625967d45f31b5be12c80174f0f282044b8015ed666b01f0c0065fc205b
blockNumber          13
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    208676789
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x29ca2625967d45f31b5be12c80174f0f282044b8015ed666b01f0c0065fc205b","blockNumber":"0xd","blockTimestamp":"0x69280407","transactionHash":"0xbc64e90e347e340ec026b1e9e8fc5f439487a0ea9fcfd8de6933c2aa4f76ebbb","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000120000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000020000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xbc64e90e347e340ec026b1e9e8fc5f439487a0ea9fcfd8de6933c2aa4f76ebbb
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.039s
user    0m0.019s
sys     0m0.046s
[*] Receiver KHÔNG claim → mô phỏng griefing.
[*] Tăng thời gian vượt TIMELOCK=1800 s...
1801
"0x0"
[*] Sender refund...

blockHash            0xd051754e7e1f012c6bfa7be1155e8a9f1811955b2f665412d95f56eb1e5114cb
blockNumber          15
contractAddress      
cumulativeGasUsed    69408
effectiveGasPrice    159895332
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              69408
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xd051754e7e1f012c6bfa7be1155e8a9f1811955b2f665412d95f56eb1e5114cb","blockNumber":"0xf","blockTimestamp":"0x69280b11","transactionHash":"0x2bde3d672f2b0aabf9c3e9e120e26bd3997f700ef9a3ed555491c2e5b149bd8e","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0xf1528c24263513f74556325fb8501788dc44a87d280be766744a243315e4c57a","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xd051754e7e1f012c6bfa7be1155e8a9f1811955b2f665412d95f56eb1e5114cb","blockNumber":"0xf","blockTimestamp":"0x69280b11","transactionHash":"0x2bde3d672f2b0aabf9c3e9e120e26bd3997f700ef9a3ed555491c2e5b149bd8e","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402004000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000014000000000000000020004000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x2bde3d672f2b0aabf9c3e9e120e26bd3997f700ef9a3ed555491c2e5b149bd8e
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.791s
user    0m0.009s
sys     0m0.067s
[*] Balance sender (token) sau refund:
900000000000000000000 [9e20]
[*] Balance sender (ETH) – nhận thêm penalty ≈ depositRequired:
100999823799712935759

==================== Scenario C – Không confirm deposit, refund sau depositWindow, penalty = 0 ====================

[*] createLock (LOCK_ID_C) – KHÔNG confirmParticipation...

blockHash            0xd39f44a0e9f56530040e6a3c9780ec6f5ae14d5fb826cefd0fcd725273814c8c
blockNumber          16
contractAddress      
cumulativeGasUsed    245868
effectiveGasPrice    140000900
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              245868
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xd39f44a0e9f56530040e6a3c9780ec6f5ae14d5fb826cefd0fcd725273814c8c","blockNumber":"0x10","blockTimestamp":"0x69280b12","transactionHash":"0x82876b348a75309e315e2daec3966af4970730e5ecb765b57376fb0723287b77","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x211974fc67bb5ea63cf9d02ac6890d8f1e32d01a4651fac202452bf74ca41297","0x56f1f34a217edd60ed42a274fce63d527b2e80dd3646e2aebc54840de63d10d6","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000000000000000000000000000000000000000000000000000000000006928121a0000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000069280d6a","blockHash":"0xd39f44a0e9f56530040e6a3c9780ec6f5ae14d5fb826cefd0fcd725273814c8c","blockNumber":"0x10","blockTimestamp":"0x69280b12","transactionHash":"0x82876b348a75309e315e2daec3966af4970730e5ecb765b57376fb0723287b77","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000020000000000000000000000008000000000000000000000000000000100000000000000840000080000000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000004000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000002000000000001000000000000800000000400000000
root                 
status               1 (success)
transactionHash      0x82876b348a75309e315e2daec3966af4970730e5ecb765b57376fb0723287b77
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.040s
user    0m0.004s
sys     0m0.065s
[*] Tăng thời gian qua depositWindow=600 s (nhưng có thể < timelock)...
2402
"0x0"
[*] Sender refund (nhánh !depositConfirmed)...

blockHash            0xdf5d5fd6b646c415ceaa28888f7333f08ca5db719938479ceee077662a094300
blockNumber          18
contractAddress      
cumulativeGasUsed    77847
effectiveGasPrice    107439182
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              77847
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xdf5d5fd6b646c415ceaa28888f7333f08ca5db719938479ceee077662a094300","blockNumber":"0x12","blockTimestamp":"0x69280d6c","transactionHash":"0x9dcafb5e14fae5eecde2dfa576f6d1e53d4568222dca90bb3cde58a8c5e51bbc","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x56f1f34a217edd60ed42a274fce63d527b2e80dd3646e2aebc54840de63d10d6","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xdf5d5fd6b646c415ceaa28888f7333f08ca5db719938479ceee077662a094300","blockNumber":"0x12","blockTimestamp":"0x69280d6c","transactionHash":"0x9dcafb5e14fae5eecde2dfa576f6d1e53d4568222dca90bb3cde58a8c5e51bbc","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000100000000000000840000000000000000000000000000000000000000000000014000000000000000000004000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000002000000000001000000000000800000000400000000
root                 
status               1 (success)
transactionHash      0x9dcafb5e14fae5eecde2dfa576f6d1e53d4568222dca90bb3cde58a8c5e51bbc
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.038s
user    0m0.027s
sys     0m0.038s
[*] Balance sender (token) sau refund:
900000000000000000000 [9e20]
[*] Balance sender (ETH) – không có penalty vì depositPaid = 0:
100999781014153653405

==================== Hoàn tất PoC HTLC-GP – Scenario A + B + C ====================

Xem thêm logs/deploy_htlc_gp.log để lấy tx hash rồi:
  cast receipt <TX_HASH> --rpc-url http://127.0.0.1:8545
để đo gas lock/claim/refund cho bảng kết quả.
[*] stop anvil (PID=23658)
```

#HTLC-GPz
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC-GPZ bằng forge script ====================

[*] ADDR_TOKEN_GPZ = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_GPZ  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0x1ae4f5d263e2562bc7d77bf664d185d49e94afdcb3dc8effb89ab1a237bf9e13
blockNumber          6
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    528529315
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x1ae4f5d263e2562bc7d77bf664d185d49e94afdcb3dc8effb89ab1a237bf9e13","blockNumber":"0x6","blockTimestamp":"0x692805df","transactionHash":"0x210dbe5722fadbc61c0181ca92ea6eb1153ccecb9b2a1b1fc6c0cf30dcf3d15f","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x210dbe5722fadbc61c0181ca92ea6eb1153ccecb9b2a1b1fc6c0cf30dcf3d15f
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE_S1 / LOCK_ID_S1 = 0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449
[*] PREIMAGE_S2 / LOCK_ID_S2 = 0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f
[*] PREIMAGE_S3 / LOCK_ID_S3 = 0xd593e36ed29ddefc1db8210159a46842ee6989c843e2388c9c1c8b42d392c2b9
[*] PREIMAGE_S4 / LOCK_ID_S4 = 0xe7522daf1d812fddbfa9834fc8d10931d6f930254352a03978571339d6b00f65
[*] PREIMAGE_S5 / LOCK_ID_S5 = 0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160

==================== Approve token cho HTLC-GPZ ====================


blockHash            0xc4c8ade91857fad7fececf4b225f5af738c2c9e692adbe6d559d08eed44f1d37
blockNumber          7
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    462778688
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xc4c8ade91857fad7fececf4b225f5af738c2c9e692adbe6d559d08eed44f1d37","blockNumber":"0x7","blockTimestamp":"0x692805e0","transactionHash":"0x30cbcb7925840ba451eabade236eb5e03ccd3b4d08e62ccd27854fcb194d5ef6","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x30cbcb7925840ba451eabade236eb5e03ccd3b4d08e62ccd27854fcb194d5ef6
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario 1 – claim sớm, penalty = 0 ====================

[*] createLock S1...

blockHash            0xd9866f58bcbce17ce67d43ff7ad018603a7cc6202531b0de2e7bd4da099638b8
blockNumber          8
contractAddress      
cumulativeGasUsed    269322
effectiveGasPrice    405118666
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              269322
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xd9866f58bcbce17ce67d43ff7ad018603a7cc6202531b0de2e7bd4da099638b8","blockNumber":"0x8","blockTimestamp":"0x692805e1","transactionHash":"0x86fd60fac8c35a9e5bc3b1a0e743c98af56c62ef8b67e1bb378e99b8e269e14a","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280ce900000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000069280839","blockHash":"0xd9866f58bcbce17ce67d43ff7ad018603a7cc6202531b0de2e7bd4da099638b8","blockNumber":"0x8","blockTimestamp":"0x692805e1","transactionHash":"0x86fd60fac8c35a9e5bc3b1a0e743c98af56c62ef8b67e1bb378e99b8e269e14a","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840000000020000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000100000000000000000000000000000000000000000042000000200000000000001000000000082000000000000000000000000000000000000000000400000000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0x86fd60fac8c35a9e5bc3b1a0e743c98af56c62ef8b67e1bb378e99b8e269e14a
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.036s
user    0m0.013s
sys     0m0.050s
[*] confirmParticipation S1...

blockHash            0xbdba5d1e4b9b10e6913e8c33ceaaa7ab7b8fa34a077ddeff29b0f85748032b3a
blockNumber          9
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    355388061
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xbdba5d1e4b9b10e6913e8c33ceaaa7ab7b8fa34a077ddeff29b0f85748032b3a","blockNumber":"0x9","blockTimestamp":"0x692805e2","transactionHash":"0x45b18aa0b72e2f3d70e5c721d7a165803ff5b3a08982d24b374e749bc7cbead9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000020000000100000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000200000000000001000000000082000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x45b18aa0b72e2f3d70e5c721d7a165803ff5b3a08982d24b374e749bc7cbead9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.033s
user    0m0.027s
sys     0m0.031s
[*] claim S1 (trước penalty window)...

blockHash            0x40da08df1a2ac004cd23ad6f941f50bf2cf9a05a72d56db20227e6e19bee5887
blockNumber          10
contractAddress      
cumulativeGasUsed    93660
effectiveGasPrice    311212061
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              93660
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x40da08df1a2ac004cd23ad6f941f50bf2cf9a05a72d56db20227e6e19bee5887","blockNumber":"0xa","blockTimestamp":"0x692805e3","transactionHash":"0x3fffc3ec8a2065177deb6875fcf03806193035be729532249fb3244f5a6d53fb","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0x40da08df1a2ac004cd23ad6f941f50bf2cf9a05a72d56db20227e6e19bee5887","blockNumber":"0xa","blockTimestamp":"0x692805e3","transactionHash":"0x3fffc3ec8a2065177deb6875fcf03806193035be729532249fb3244f5a6d53fb","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400400000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000040000000020000000100000000000000000000000000000014000000000000000000000000002000000000000000000000000000000000000200000000000000000000000000000002000100000000000000000000000000000000000000000042000000200000000000001000000000082000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x3fffc3ec8a2065177deb6875fcf03806193035be729532249fb3244f5a6d53fb
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.035s
user    0m0.017s
sys     0m0.035s
[*] Balance receiver (token) sau S1:
100000000000000000000 [1e20]

==================== Scenario 2 – claim trong penalty window (0 < penalty < deposit) ====================

[*] createLock S2...

blockHash            0x4b25e72a5c5158fbe1a4e9a6a1dc3c74cf2ae2801e4efe1b828023884debcd98
blockNumber          11
contractAddress      
cumulativeGasUsed    269322
effectiveGasPrice    272553455
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              269322
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x4b25e72a5c5158fbe1a4e9a6a1dc3c74cf2ae2801e4efe1b828023884debcd98","blockNumber":"0xb","blockTimestamp":"0x692805e4","transactionHash":"0xeae5f54514ad64a8770af1541b1d99d20294bb2b02300a1a13adfa7c5c45dd50","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280cec00000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000006928083c","blockHash":"0x4b25e72a5c5158fbe1a4e9a6a1dc3c74cf2ae2801e4efe1b828023884debcd98","blockNumber":"0xb","blockTimestamp":"0x692805e4","transactionHash":"0xeae5f54514ad64a8770af1541b1d99d20294bb2b02300a1a13adfa7c5c45dd50","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000000000000000000000000000040000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000400000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000001200000000000001000000000002000000000000000000000000000000000000000000400000000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0xeae5f54514ad64a8770af1541b1d99d20294bb2b02300a1a13adfa7c5c45dd50
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.036s
user    0m0.009s
sys     0m0.044s
[*] confirmParticipation S2...

blockHash            0x856a164418d74939e2e22ea85295d605339596edccf4a46b8a7275b9a0669d57
blockNumber          12
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    239095979
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x856a164418d74939e2e22ea85295d605339596edccf4a46b8a7275b9a0669d57","blockNumber":"0xc","blockTimestamp":"0x692805e5","transactionHash":"0xb091f9a780fab4d4dde9dcb5cb37413afa3dbca2dcdc0132272e21fda99a9e7c","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000040000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000400000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xb091f9a780fab4d4dde9dcb5cb37413afa3dbca2dcdc0132272e21fda99a9e7c
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m3.559s
user    0m0.020s
sys     0m0.046s
[*] Nhảy thời gian ~ 1300s để vào giữa penalty window...
1300
"0x0"
[*] claim S2 (bị phạt tuyến tính)...

blockHash            0xcf2b39edab1e9cb5696782665a08c56cd1689359b6ee5355aee1e84c44b80e12
blockNumber          14
contractAddress      
cumulativeGasUsed    90186
effectiveGasPrice    183203562
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              90186
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xcf2b39edab1e9cb5696782665a08c56cd1689359b6ee5355aee1e84c44b80e12","blockNumber":"0xe","blockTimestamp":"0x69280afd","transactionHash":"0xc3bc49eae321227976a4d842f5d6a8ab4f5b9e78ed31083a488ad1fa3a99e932","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x000000000000000000000000000000000000000000000000026db992a3b18000","blockHash":"0xcf2b39edab1e9cb5696782665a08c56cd1689359b6ee5355aee1e84c44b80e12","blockNumber":"0xe","blockTimestamp":"0x69280afd","transactionHash":"0xc3bc49eae321227976a4d842f5d6a8ab4f5b9e78ed31083a488ad1fa3a99e932","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400400000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000040000000008000000000000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000400000000000000002000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000001200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xc3bc49eae321227976a4d842f5d6a8ab4f5b9e78ed31083a488ad1fa3a99e932
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.788s
user    0m0.009s
sys     0m0.049s
[*] Balance sender/receiver (ETH) sau S2:
100174795010365373190
99824866782298593373

==================== Scenario 3 – claim rất trễ, penalty ≈ full deposit ====================

[*] createLock S3...

blockHash            0x3cab954c1fac2b9fa72e1ead95b96446b5ea17cc2e1bf8e8c65c96cf845420b8
blockNumber          15
contractAddress      
cumulativeGasUsed    269322
effectiveGasPrice    160440804
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              269322
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x3cab954c1fac2b9fa72e1ead95b96446b5ea17cc2e1bf8e8c65c96cf845420b8","blockNumber":"0xf","blockTimestamp":"0x69280afe","transactionHash":"0x3653c76ce87e32428cf76367be9fca676639fed3d5a8b56a983e9e8677a40b5f","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0xd593e36ed29ddefc1db8210159a46842ee6989c843e2388c9c1c8b42d392c2b9","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000000000000000000000000000000000000000000000000000000000006928120600000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000069280d56","blockHash":"0x3cab954c1fac2b9fa72e1ead95b96446b5ea17cc2e1bf8e8c65c96cf845420b8","blockNumber":"0xf","blockTimestamp":"0x69280afe","transactionHash":"0x3653c76ce87e32428cf76367be9fca676639fed3d5a8b56a983e9e8677a40b5f","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000010000410000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000002000000000000000000000000000000400000000000001000000000000802040000000000000
root                 
status               1 (success)
transactionHash      0x3653c76ce87e32428cf76367be9fca676639fed3d5a8b56a983e9e8677a40b5f
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.036s
user    0m0.016s
sys     0m0.044s
[*] confirmParticipation S3...

blockHash            0x4cc4cb9eb9002015197b3fe16127389f9a5b8b98feded77d1d5ce92c00857464
blockNumber          16
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    140745789
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0xd593e36ed29ddefc1db8210159a46842ee6989c843e2388c9c1c8b42d392c2b9","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x4cc4cb9eb9002015197b3fe16127389f9a5b8b98feded77d1d5ce92c00857464","blockNumber":"0x10","blockTimestamp":"0x69280aff","transactionHash":"0x2900b2ac8a8c51e5b2e8188393bb58b4ce4bf7a71223ba1e314666d5aa4a25e3","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000002000000000000000000000000000000000000000000000000000000000800040000000000000
root                 
status               1 (success)
transactionHash      0x2900b2ac8a8c51e5b2e8188393bb58b4ce4bf7a71223ba1e314666d5aa4a25e3
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.009s
sys     0m0.053s
[*] Nhảy thời gian ~ TIMELOCK-1 (=1799)...
3098
"0x0"
[*] claim S3 (sát unlockTime)...

blockHash            0xaf127220fc3b3c4c119b95954268e6258330c7fedc7d676ef23a09237d4f2fd7
blockNumber          18
contractAddress      
cumulativeGasUsed    40083
effectiveGasPrice    107844264
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              40083
logs                 []
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
root                 
status               0 (failed)
transactionHash      0xc8c746b3e7cc770f14c7566d09887dfdefa36c400c6bb9f90b3806a094321e51
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.791s
user    0m0.009s
sys     0m0.060s
[*] Balance sender/receiver (ETH) sau S3:
100174751800127158302
98824850697029135364

==================== Scenario 4 – deposit không confirm, refund sau depositWindow (penalty = 0) ====================

[*] createLock S4 (không confirmParticipation)...

blockHash            0xde0d4abf8ce9e60600c7c1048e28c54cbfd7763b45b72abf6d5b66043e5e5785
blockNumber          19
contractAddress      
cumulativeGasUsed    252222
effectiveGasPrice    94399754
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              252222
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xde0d4abf8ce9e60600c7c1048e28c54cbfd7763b45b72abf6d5b66043e5e5785","blockNumber":"0x13","blockTimestamp":"0x69281207","transactionHash":"0x7277c544cd1840314a3b0e8825de11f8f2eb90feabe997f2681f24a1b35c3aec","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0xe7522daf1d812fddbfa9834fc8d10931d6f930254352a03978571339d6b00f65","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d63100000000000000000000000000000000000000000000000000000000000006928190f00000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000006928145f","blockHash":"0xde0d4abf8ce9e60600c7c1048e28c54cbfd7763b45b72abf6d5b66043e5e5785","blockNumber":"0x13","blockTimestamp":"0x69281207","transactionHash":"0x7277c544cd1840314a3b0e8825de11f8f2eb90feabe997f2681f24a1b35c3aec","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000000000100000000000000000200000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000400008000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0x7277c544cd1840314a3b0e8825de11f8f2eb90feabe997f2681f24a1b35c3aec
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.038s
user    0m0.026s
sys     0m0.040s
[*] Nhảy thời gian > depositWindow (601s)...
3699
"0x0"
[*] refund S4 (deposit chưa confirm, penalty = 0)...

blockHash            0xbbd6c6143cef4f0a2c941a4467517538227345ed476a61ab7661261411f7920e
blockNumber          21
contractAddress      
cumulativeGasUsed    82647
effectiveGasPrice    72448425
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              82647
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xbbd6c6143cef4f0a2c941a4467517538227345ed476a61ab7661261411f7920e","blockNumber":"0x15","blockTimestamp":"0x69281461","transactionHash":"0x5f789bc075b1138fa1a6c7ac69f12ea7cfddb628ed9e284e5d67185b123f51cc","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0xe7522daf1d812fddbfa9834fc8d10931d6f930254352a03978571339d6b00f65","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xbbd6c6143cef4f0a2c941a4467517538227345ed476a61ab7661261411f7920e","blockNumber":"0x15","blockTimestamp":"0x69281461","transactionHash":"0x5f789bc075b1138fa1a6c7ac69f12ea7cfddb628ed9e284e5d67185b123f51cc","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000000000100000000000000000200000000008000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000014000000000000000000004000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000000008000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x5f789bc075b1138fa1a6c7ac69f12ea7cfddb628ed9e284e5d67185b123f51cc
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.047s
user    0m0.023s
sys     0m0.052s
[*] Balance sender (token/ETH) sau S4:
700000000000000000000 [7e20]
100174722002787423939

==================== Scenario 5 – deposit đã confirm nhưng receiver không claim, refund sau timelock ====================

[*] createLock S5...

blockHash            0x24e36093ba909bf7f388725a83cba5b1194f61504137b6e0cf5f2d044ebe21c9
blockNumber          22
contractAddress      
cumulativeGasUsed    252222
effectiveGasPrice    63442270
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              252222
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x24e36093ba909bf7f388725a83cba5b1194f61504137b6e0cf5f2d044ebe21c9","blockNumber":"0x16","blockTimestamp":"0x69281462","transactionHash":"0xbc92858b378879d8c6cd9708aa9276b86ac8a4c8627def1ca3de480246aeb2c1","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069281b6a00000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000692816ba","blockHash":"0x24e36093ba909bf7f388725a83cba5b1194f61504137b6e0cf5f2d044ebe21c9","blockNumber":"0x16","blockTimestamp":"0x69281462","transactionHash":"0xbc92858b378879d8c6cd9708aa9276b86ac8a4c8627def1ca3de480246aeb2c1","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000004000000000000000000000000000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000000000000002000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000400000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000400000000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0xbc92858b378879d8c6cd9708aa9276b86ac8a4c8627def1ca3de480246aeb2c1
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.812s
user    0m0.024s
sys     0m0.074s
[*] confirmParticipation S5...

blockHash            0xf5f375fc0d609a95bccfac7bb8b1c0c0c832d85c4f5df6db39cfa959e4326c33
blockNumber          23
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    55645333
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xf5f375fc0d609a95bccfac7bb8b1c0c0c832d85c4f5df6db39cfa959e4326c33","blockNumber":"0x17","blockTimestamp":"0x69281463","transactionHash":"0xd98a0e6b4042a92bb7a985b5a9ac2c1ead96f9d08c17854809e592dab54de3f7","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000004000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000002000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xd98a0e6b4042a92bb7a985b5a9ac2c1ead96f9d08c17854809e592dab54de3f7
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.037s
user    0m0.020s
sys     0m0.041s
[*] Receiver KHÔNG claim → mô phỏng griefing chậm.
[*] Nhảy thời gian > timelock (1801)...
5500
"0x0"
[*] refund S5 (sender nhận lại token + full deposit)...

blockHash            0xbb5d5e59b35491744a4a890c099e2b1284ba11592b500f3c7c0e5879cccfd5f6
blockNumber          25
contractAddress      
cumulativeGasUsed    74208
effectiveGasPrice    42637369
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              74208
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xbb5d5e59b35491744a4a890c099e2b1284ba11592b500f3c7c0e5879cccfd5f6","blockNumber":"0x19","blockTimestamp":"0x69281b6d","transactionHash":"0x7e271d60915c9e4ab48189610042de349e8bfa93504bb78cd76360c9c34c542e","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xbb5d5e59b35491744a4a890c099e2b1284ba11592b500f3c7c0e5879cccfd5f6","blockNumber":"0x19","blockTimestamp":"0x69281b6d","transactionHash":"0x7e271d60915c9e4ab48189610042de349e8bfa93504bb78cd76360c9c34c542e","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000004000000000000000000000000000000008000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000014000000000000000000006000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000400000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x7e271d60915c9e4ab48189610042de349e8bfa93504bb78cd76360c9c34c542e
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.816s
user    0m0.044s
sys     0m0.094s
[*] Balance sender (token/ETH) sau S5:
700000000000000000000 [7e20]
101174702837217321247

==================== Hoàn tất PoC HTLC-GPZ – Scenario 1 → 5 ====================
```
```bash
[*] start anvil...

==================== Deploy MockToken + HTLC-GPZ bằng forge script ====================

[*] ADDR_TOKEN_GPZ = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] ADDR_HTLC_GPZ  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

==================== Config account sender/receiver + cấp ETH + mint token ====================

[*] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] ADDR_SENDER   = 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
null
null

blockHash            0x18b4abf14fdb631eda03faf3eee0185ad95906f02fb982649c83c9ee9b468616
blockNumber          7
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    462463151
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x18b4abf14fdb631eda03faf3eee0185ad95906f02fb982649c83c9ee9b468616","blockNumber":"0x7","blockTimestamp":"0x6928067d","transactionHash":"0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x3cff40634010af7ae373c14ec2a672c57634a2c03c5a33ff29cab3bbcf4299c9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] PREIMAGE_S1 / LOCK_ID_S1 = 0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449
[*] PREIMAGE_S2 / LOCK_ID_S2 = 0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f
[*] PREIMAGE_S3 / LOCK_ID_S3 = 0xd593e36ed29ddefc1db8210159a46842ee6989c843e2388c9c1c8b42d392c2b9
[*] PREIMAGE_S4 / LOCK_ID_S4 = 0xe7522daf1d812fddbfa9834fc8d10931d6f930254352a03978571339d6b00f65
[*] PREIMAGE_S5 / LOCK_ID_S5 = 0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160

==================== Approve token cho HTLC-GPZ ====================


blockHash            0x91e5c27cad321cf14fa6fea39cd99377df0e9fa7b78377754639eb9e74504f8f
blockNumber          8
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    404931352
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x91e5c27cad321cf14fa6fea39cd99377df0e9fa7b78377754639eb9e74504f8f","blockNumber":"0x8","blockTimestamp":"0x6928067e","transactionHash":"0xd1ce33b7ae9c5a260a7ccdda0947e26cc6d1523c1414a7a5b3c42af4b711fb24","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000001000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xd1ce33b7ae9c5a260a7ccdda0947e26cc6d1523c1414a7a5b3c42af4b711fb24
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3

==================== Scenario 1 – claim sớm, penalty = 0 ====================

[*] createLock S1...

blockHash            0x7ad3cf84141bf812d7ade5abaaee33442cb0be518fe212bc149c2ba19d880738
blockNumber          9
contractAddress      
cumulativeGasUsed    269322
effectiveGasPrice    354478833
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              269322
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x7ad3cf84141bf812d7ade5abaaee33442cb0be518fe212bc149c2ba19d880738","blockNumber":"0x9","blockTimestamp":"0x6928067f","transactionHash":"0xc5cb292d8c10dd3fd7f5e8f0da2c9693c42a2c64031324a66dcdaad7b6a69f46","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280d8700000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000692808d7","blockHash":"0x7ad3cf84141bf812d7ade5abaaee33442cb0be518fe212bc149c2ba19d880738","blockNumber":"0x9","blockTimestamp":"0x6928067f","transactionHash":"0xc5cb292d8c10dd3fd7f5e8f0da2c9693c42a2c64031324a66dcdaad7b6a69f46","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840000000020000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000100000000000000000000000000000000000000000042000000200000000000001000000000082000000000000000000000000000000000000000000400000000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0xc5cb292d8c10dd3fd7f5e8f0da2c9693c42a2c64031324a66dcdaad7b6a69f46
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.044s
user    0m0.010s
sys     0m0.072s
[*] confirmParticipation S1...

blockHash            0x825e4a37a2bac3c188c4bea13f83d16a96e239971679be7ef16d3d6dfd3c1dad
blockNumber          10
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    310964554
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x825e4a37a2bac3c188c4bea13f83d16a96e239971679be7ef16d3d6dfd3c1dad","blockNumber":"0xa","blockTimestamp":"0x69280680","transactionHash":"0x0f1b2137c20caf21cce9da954d45d15980364c18373db1b4a5f0fefe1ec6f555","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000020000000100000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000200000000000001000000000082000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x0f1b2137c20caf21cce9da954d45d15980364c18373db1b4a5f0fefe1ec6f555
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.023s
sys     0m0.038s
[*] claim S1 (trước penalty window)...

blockHash            0xd1e9feb7bdb0fc26248b4f32379ebc81378f8230d051d99616b2ada3f86846c7
blockNumber          11
contractAddress      
cumulativeGasUsed    93660
effectiveGasPrice    272310554
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              93660
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xd1e9feb7bdb0fc26248b4f32379ebc81378f8230d051d99616b2ada3f86846c7","blockNumber":"0xb","blockTimestamp":"0x69280681","transactionHash":"0x87414b4269476eee825ed7ff3bb41c32760ea2999c9e057b5b5b52b1c6f8cdce","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0x9bf4daf49edf2f40ae38d60e71d91ba8d59042ac39a98cf5721aecd3d249e449","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xd1e9feb7bdb0fc26248b4f32379ebc81378f8230d051d99616b2ada3f86846c7","blockNumber":"0xb","blockTimestamp":"0x69280681","transactionHash":"0x87414b4269476eee825ed7ff3bb41c32760ea2999c9e057b5b5b52b1c6f8cdce","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400400000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000040000000020000000100000000000000000000000000000014000000000000000000000000002000000000000000000000000000000000000200000000000000000000000000000002000100000000000000000000000000000000000000000042000000200000000000001000000000082000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x87414b4269476eee825ed7ff3bb41c32760ea2999c9e057b5b5b52b1c6f8cdce
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.033s
user    0m0.011s
sys     0m0.047s
[*] Balance receiver (token) sau S1:
100000000000000000000 [1e20]

==================== Scenario 2 – claim trong penalty window (0 < penalty < deposit) ====================

[*] createLock S2...

blockHash            0xf37938b627a3aa0085faaaa8105c3dfd28deacbac36017b7cb3b87b5379507d2
blockNumber          12
contractAddress      
cumulativeGasUsed    269322
effectiveGasPrice    238484274
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              269322
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xf37938b627a3aa0085faaaa8105c3dfd28deacbac36017b7cb3b87b5379507d2","blockNumber":"0xc","blockTimestamp":"0x69280682","transactionHash":"0x7c03a123bc5301b09415b46f05b14628053e8f8f4352c4f263817740cec82433","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069280d8a00000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000692808da","blockHash":"0xf37938b627a3aa0085faaaa8105c3dfd28deacbac36017b7cb3b87b5379507d2","blockNumber":"0xc","blockTimestamp":"0x69280682","transactionHash":"0x7c03a123bc5301b09415b46f05b14628053e8f8f4352c4f263817740cec82433","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000000000000000000000000000040000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000400000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000001200000000000001000000000002000000000000000000000000000000000000000000400000000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0x7c03a123bc5301b09415b46f05b14628053e8f8f4352c4f263817740cec82433
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.004s
sys     0m0.066s
[*] confirmParticipation S2...

blockHash            0x3b3267335420e90852d8baf7d413c1e15abf5436ad10ff00f778bef12900e753
blockNumber          13
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    209208983
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x3b3267335420e90852d8baf7d413c1e15abf5436ad10ff00f778bef12900e753","blockNumber":"0xd","blockTimestamp":"0x69280683","transactionHash":"0xb61bce050235752622928c81ba8c91ca2dcca3bd99540788dc405d5257d72906","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000040000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000400000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xb61bce050235752622928c81ba8c91ca2dcca3bd99540788dc405d5257d72906
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.029s
user    0m0.008s
sys     0m0.046s
[*] Nhảy thời gian ~ 1300s để vào giữa penalty window...
1300
"0x0"
[*] claim S2 (bị phạt tuyến tính)...

blockHash            0x21588ba6b5ab10a9327ea37e3031eb1de1702841a82a62e7bc225d4970bccf85
blockNumber          15
contractAddress      
cumulativeGasUsed    90186
effectiveGasPrice    160303118
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              90186
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x21588ba6b5ab10a9327ea37e3031eb1de1702841a82a62e7bc225d4970bccf85","blockNumber":"0xf","blockTimestamp":"0x69280b98","transactionHash":"0x5b532dc497901df7360af7e553e0e31fa2e7008d8341aa0599bf718af4e269d8","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0xe7370f8668c9d83f5194e1cd1e4b2c7224bc775d14b0e294be3aad8a9561014f","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x000000000000000000000000000000000000000000000000025bf6196bd10000","blockHash":"0x21588ba6b5ab10a9327ea37e3031eb1de1702841a82a62e7bc225d4970bccf85","blockNumber":"0xf","blockTimestamp":"0x69280b98","transactionHash":"0x5b532dc497901df7360af7e553e0e31fa2e7008d8341aa0599bf718af4e269d8","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400400000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000040000000008000000000000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000400000000000000002000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000001200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x5b532dc497901df7360af7e553e0e31fa2e7008d8341aa0599bf718af4e269d8
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.783s
user    0m0.012s
sys     0m0.044s
[*] Balance sender/receiver (ETH) sau S2:
100169820634069398554
99829883434510903920

==================== Scenario 3 – claim rất trễ, penalty ≈ full deposit ====================

[*] createLock S3...

blockHash            0x7ed4ae8480212bb74f39f403905a857a9d385ee36d0d2aeeee5c181bcaa87c7a
blockNumber          16
contractAddress      
cumulativeGasUsed    269322
effectiveGasPrice    140385705
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              269322
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x7ed4ae8480212bb74f39f403905a857a9d385ee36d0d2aeeee5c181bcaa87c7a","blockNumber":"0x10","blockTimestamp":"0x69280b99","transactionHash":"0x08a3915718dae96a9e3a90f01454ac389ab7cef6f4ddeeedeb3394cf5ab39d32","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0xd593e36ed29ddefc1db8210159a46842ee6989c843e2388c9c1c8b42d392c2b9","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d6310000000000000000000000000000000000000000000000000000000000000692812a100000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000069280df1","blockHash":"0x7ed4ae8480212bb74f39f403905a857a9d385ee36d0d2aeeee5c181bcaa87c7a","blockNumber":"0x10","blockTimestamp":"0x69280b99","transactionHash":"0x08a3915718dae96a9e3a90f01454ac389ab7cef6f4ddeeedeb3394cf5ab39d32","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000010000410000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000002000000000000000000000000000000400000000000001000000000000802040000000000000
root                 
status               1 (success)
transactionHash      0x08a3915718dae96a9e3a90f01454ac389ab7cef6f4ddeeedeb3394cf5ab39d32
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.023s
sys     0m0.040s
[*] confirmParticipation S3...

blockHash            0xb44835732dc42c26cfe3970125869e6ab50c56d36174ff2d42e16e9276eb15e6
blockNumber          17
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    123152567
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0xd593e36ed29ddefc1db8210159a46842ee6989c843e2388c9c1c8b42d392c2b9","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xb44835732dc42c26cfe3970125869e6ab50c56d36174ff2d42e16e9276eb15e6","blockNumber":"0x11","blockTimestamp":"0x69280b9a","transactionHash":"0xf8e71617344f9ff656aec786b1a3b3a5152656c75431f85da1397dc3390f89c1","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000002000000000000000000000000000000000000000000000000000000000800040000000000000
root                 
status               1 (success)
transactionHash      0xf8e71617344f9ff656aec786b1a3b3a5152656c75431f85da1397dc3390f89c1
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.031s
user    0m0.007s
sys     0m0.049s
[*] Nhảy thời gian ~ TIMELOCK-1 (=1799)...
3098
"0x0"
[*] claim S3 (sát unlockTime)...

blockHash            0xcfa1a4790578f9cd8664a2790b55da15bed34dab6bc521354f29fb3b1629d04a
blockNumber          19
contractAddress      
cumulativeGasUsed    40083
effectiveGasPrice    94363732
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              40083
logs                 []
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
root                 
status               0 (failed)
transactionHash      0x764d822db2ea53ed4bc9660b352cebde0579b7585ed212098d970ab40f688ef9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.036s
user    0m0.012s
sys     0m0.053s
[*] Balance sender/receiver (ETH) sau S3:
100169782825110556544
98829869359899952273

==================== Scenario 4 – deposit không confirm, refund sau depositWindow (penalty = 0) ====================

[*] createLock S4 (không confirmParticipation)...

blockHash            0x21542b4ba735cac7471b1353d805d55405b02762cd6fed23da36b2043e6626d9
blockNumber          20
contractAddress      
cumulativeGasUsed    252222
effectiveGasPrice    82599786
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              252222
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x21542b4ba735cac7471b1353d805d55405b02762cd6fed23da36b2043e6626d9","blockNumber":"0x14","blockTimestamp":"0x692812a2","transactionHash":"0x80a39fa47e0f0eb16caebc246becbd1f639efad74f0807b9fc1975c28b07a5e7","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0xe7522daf1d812fddbfa9834fc8d10931d6f930254352a03978571339d6b00f65","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d6310000000000000000000000000000000000000000000000000000000000000692819aa00000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000692814fa","blockHash":"0x21542b4ba735cac7471b1353d805d55405b02762cd6fed23da36b2043e6626d9","blockNumber":"0x14","blockTimestamp":"0x692812a2","transactionHash":"0x80a39fa47e0f0eb16caebc246becbd1f639efad74f0807b9fc1975c28b07a5e7","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000000000100000000000000000200000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000400008000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0x80a39fa47e0f0eb16caebc246becbd1f639efad74f0807b9fc1975c28b07a5e7
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.781s
user    0m0.010s
sys     0m0.046s
[*] Nhảy thời gian > depositWindow (601s)...
3699
"0x0"
[*] refund S4 (deposit chưa confirm, penalty = 0)...

blockHash            0xa30ec48e67fe1d676f6d06ec3bb5ca068b314dbf8f67a4dfb9364439fcea12c9
blockNumber          22
contractAddress      
cumulativeGasUsed    82647
effectiveGasPrice    63392373
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              82647
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xa30ec48e67fe1d676f6d06ec3bb5ca068b314dbf8f67a4dfb9364439fcea12c9","blockNumber":"0x16","blockTimestamp":"0x692814fc","transactionHash":"0xf12f01a6ac0079dbf4a0844e3ce8cd54fd02cb952d05e2de23bd40d42b51e8d4","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0xe7522daf1d812fddbfa9834fc8d10931d6f930254352a03978571339d6b00f65","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xa30ec48e67fe1d676f6d06ec3bb5ca068b314dbf8f67a4dfb9364439fcea12c9","blockNumber":"0x16","blockTimestamp":"0x692814fc","transactionHash":"0xf12f01a6ac0079dbf4a0844e3ce8cd54fd02cb952d05e2de23bd40d42b51e8d4","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000000000100000000000000000200000000008000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000014000000000000000000004000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000000008000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xf12f01a6ac0079dbf4a0844e3ce8cd54fd02cb952d05e2de23bd40d42b51e8d4
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.033s
user    0m0.020s
sys     0m0.040s
[*] Balance sender (token/ETH) sau S4:
700000000000000000000 [7e20]
100169756752437880721

==================== Scenario 5 – deposit đã confirm nhưng receiver không claim, refund sau timelock ====================

[*] createLock S5...

blockHash            0x42e1ec20cedc99fc6ffe806ae902050f32c92473e5725e98da0ee413bde107c6
blockNumber          23
contractAddress      
cumulativeGasUsed    252222
effectiveGasPrice    55511987
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              252222
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x42e1ec20cedc99fc6ffe806ae902050f32c92473e5725e98da0ee413bde107c6","blockNumber":"0x17","blockTimestamp":"0x692814fd","transactionHash":"0xc19eb3f769dd47f90bb26186f324a4f262fd5c7b8840d3d682ef16786951b7ad","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x2f8c2f5625da877253b946781075523d7aa913096b2c55a26ef0089167a39a3c","0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000005fbdb2315678afecb367f032d93f642f64180aa30000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000000000069281c0500000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000069281755","blockHash":"0x42e1ec20cedc99fc6ffe806ae902050f32c92473e5725e98da0ee413bde107c6","blockNumber":"0x17","blockTimestamp":"0x692814fd","transactionHash":"0xc19eb3f769dd47f90bb26186f324a4f262fd5c7b8840d3d682ef16786951b7ad","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000000000000000000000000000000000000410000000000000000000004000000000000000000000000000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000014000000000000000000002000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000400000000000000000000000000042000000200000000000001000000000002000000000000000000000000000000000000000000400000000000001000000000000802000000000000000
root                 
status               1 (success)
transactionHash      0xc19eb3f769dd47f90bb26186f324a4f262fd5c7b8840d3d682ef16786951b7ad
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.033s
user    0m0.006s
sys     0m0.052s
[*] confirmParticipation S5...

blockHash            0x4118d29241a63c19c03eee8c14dd60a85d549427ecbeca68641337efe3ae552a
blockNumber          24
contractAddress      
cumulativeGasUsed    83573
effectiveGasPrice    48689667
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83573
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x4118d29241a63c19c03eee8c14dd60a85d549427ecbeca68641337efe3ae552a","blockNumber":"0x18","blockTimestamp":"0x692814fe","transactionHash":"0xd6e06658bba721b2cdf96cf51a25e5bdec1ce3d05846c3998a742686f3b7d197","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000004000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000002000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000200000000000001000000000002000000000000000000000000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xd6e06658bba721b2cdf96cf51a25e5bdec1ce3d05846c3998a742686f3b7d197
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m0.785s
user    0m0.005s
sys     0m0.052s
[*] Receiver KHÔNG claim → mô phỏng griefing chậm.
[*] Nhảy thời gian > timelock (1801)...
5500
"0x0"
[*] refund S5 (sender nhận lại token + full deposit)...

blockHash            0xef0af199197402e37087425e0f3e8e6561c082eb561aafa6257f3633eb12ca3d
blockNumber          26
contractAddress      
cumulativeGasUsed    74208
effectiveGasPrice    37307698
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              74208
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xef0af199197402e37087425e0f3e8e6561c082eb561aafa6257f3633eb12ca3d","blockNumber":"0x1a","blockTimestamp":"0x69281c08","transactionHash":"0x8ac984ad4404ade0972765440a49fde4ac5cdff14d50618e86ffa5e7122e69e5","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x888172aa8893f397a5928beba90d5ab9a41b34a52064c5ef65c7a58bd135e160","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xef0af199197402e37087425e0f3e8e6561c082eb561aafa6257f3633eb12ca3d","blockNumber":"0x1a","blockTimestamp":"0x69281c08","transactionHash":"0x8ac984ad4404ade0972765440a49fde4ac5cdff14d50618e86ffa5e7122e69e5","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000402000000000000000000000000000000000000000000200000000000000000000000000000000010000000000000000000004000000000000000000000000000000008000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000014000000000000000000006000000400000000000000000000000000000000000200000000000000000000000000000002000000000000000000400000000000000000000000000042000000000000000000001000000000000000000000000000000000000000000000000000000000000000000001000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x8ac984ad4404ade0972765440a49fde4ac5cdff14d50618e86ffa5e7122e69e5
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

real    0m1.034s
user    0m0.009s
sys     0m0.047s
[*] Balance sender (token/ETH) sau S5:
700000000000000000000 [7e20]
101169739982563842423

==================== Hoàn tất PoC HTLC-GPZ – Scenario 1 → 5 ====================
```

# MP-HTLC-LGP
```bash
(base) PS D:\HTCLs\MP-HTLC-LGP\mpc-tss> go run main.go
2025/11/27 15:15:03 [P1] KEYGEN DONE
2025/11/27 15:15:03 [P3] KEYGEN DONE
2025/11/27 15:15:03 [P2] KEYGEN DONE
2025/11/27 15:15:04 ==> pubkey X=94256740529902853275359560506045934202104317935793465174151199420994709907752
Y=34411279312941769268845660358044100819709826274913882074601301779212065668651
TSS Ethereum Address = 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
Preimage: super-secret-preimage
lockId: 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
2025/11/27 15:15:04 [P1] SIGN DONE
2025/11/27 15:15:04 [P2] SIGN DONE
==> TSS signature:
r = 60bca4a63b18acc1cab0a91c7c73151625032949e907a5708ea5207a79ae817e
s = 6df408579770a6810505b630625ee5dc5a1f52dc5692d8cd9768197123d1b888
v(recid) = [1]
ECDSA verify = true
ethSig(65) = 0x60bca4a63b18acc1cab0a91c7c73151625032949e907a5708ea5207a79ae817e6df408579770a6810505b630625ee5dc5a1f52dc5692d8cd9768197123d1b88801
DONE.
TSS signing time = 52.8566571s

[*] start anvil...
[*] TSS Ethereum Address = 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
[*] LOCK_ID             = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] SIG (ethSig(65))    = 0x60bca4a63b18acc1cab0a91c7c73151625032949e907a5708ea5207a79ae817e6df408579770a6810505b630625ee5dc5a1f52dc5692d8cd9768197123d1b88801

==================== [s1] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s1] ADDR_TOKEN = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] [s1] ADDR_HTLC  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[*] [s1] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s1] ADDR_TSS      = 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
null
null

blockHash            0xd782a4a29dff25bd638ff42e47cad9ec325fa1597eabc81f0e386e28601ca68a
blockNumber          7
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    463639666
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xd782a4a29dff25bd638ff42e47cad9ec325fa1597eabc81f0e386e28601ca68a","blockNumber":"0x7","blockTimestamp":"0x692808e5","transactionHash":"0xcd3c7cc0e71a034e97cff318762ddcfdde32f1028d9ba39d49af1228d21d736d","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000080000000000000000000000040020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000100020000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0xcd3c7cc0e71a034e97cff318762ddcfdde32f1028d9ba39d49af1228d21d736d
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
null

blockHash            0xb0ce25a8816c3fc439bfa34f5f9d7f289b5a622308829c05a2d820d83615bcac
blockNumber          8
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    405961505
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xb0ce25a8816c3fc439bfa34f5f9d7f289b5a622308829c05a2d820d83615bcac","blockNumber":"0x8","blockTimestamp":"0x692808e6","transactionHash":"0xca02202fc2477886cddab2a7d9b7b588e9da040db29c01b5e416d89f3933ed6b","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000080000000000000000000000040000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000100000000010000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0xca02202fc2477886cddab2a7d9b7b588e9da040db29c01b5e416d89f3933ed6b
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] [s1] PREIMAGE      = super-secret-preimage
[*] [s1] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s1] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s1] Ready cho các scenario.

==================== [S1] Claim sớm – không penalty ====================

[S1] lock() từ TSS...

blockHash            0xc4fea343898d1875af865774878b5355904af43cae5dc2193285c666a3b90ce8
blockNumber          9
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    355380634
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              265107
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xc4fea343898d1875af865774878b5355904af43cae5dc2193285c666a3b90ce8","blockNumber":"0x9","blockTimestamp":"0x692808e7","transactionHash":"0xc8554368823bf60f7ebfcda6de4fa68718c57df5bd2dfad8ac69267ac71616e9","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000080000000000000000000000040000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0xc8554368823bf60f7ebfcda6de4fa68718c57df5bd2dfad8ac69267ac71616e9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[S1] Receiver confirmParticipation() – đặt cọc...

blockHash            0xdfba1ad30ceb67fb5d02dd1618285e8ce0893efc85fb71794315335fb4106469
blockNumber          10
contractAddress      
cumulativeGasUsed    83617
effectiveGasPrice    311743171
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83617
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xdfba1ad30ceb67fb5d02dd1618285e8ce0893efc85fb71794315335fb4106469","blockNumber":"0xa","blockTimestamp":"0x692808e8","transactionHash":"0x33e7d320b43b9130fd61c58fc8d683daaf67119b1f10202114d751e58505e54d","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x33e7d320b43b9130fd61c58fc8d683daaf67119b1f10202114d751e58505e54d
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[S1] ClaimWithSig ngay (không tăng thời gian, không bị penalty)...

blockHash            0xc78a74b55573e92a83430beb2f54d1a2ef5e4dc8056676fd21e0190e68a8af2f
blockNumber          11
contractAddress      
cumulativeGasUsed    101440
effectiveGasPrice    272992500
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              101440
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xc78a74b55573e92a83430beb2f54d1a2ef5e4dc8056676fd21e0190e68a8af2f","blockNumber":"0xb","blockTimestamp":"0x692808e9","transactionHash":"0xed59f10f40b570297422f9867c077c9a15f923f4a1df098b1fbfb9497cdb37ea","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xc78a74b55573e92a83430beb2f54d1a2ef5e4dc8056676fd21e0190e68a8af2f","blockNumber":"0xb","blockTimestamp":"0x692808e9","transactionHash":"0xed59f10f40b570297422f9867c077c9a15f923f4a1df098b1fbfb9497cdb37ea","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400400000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000002020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xed59f10f40b570297422f9867c077c9a15f923f4a1df098b1fbfb9497cdb37ea
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[S1] Balance receiver sau claim:
100000000000000000000 [1e20]
[S1] Balance TSS (ETH) sau scenario 1:
99999886068150002807

==================== [s2] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s2] ADDR_TOKEN = 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
[*] [s2] ADDR_HTLC  = 0x0165878A594ca255338adfa4d48449f69242Eb8F
[*] [s2] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s2] ADDR_TSS      = 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
null
null

blockHash            0x159f4ae18a7f4b651cf1bbf422b7b74743d2e38c331a1dbfe76a00205c85ac1f
blockNumber          16
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    144791351
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x159f4ae18a7f4b651cf1bbf422b7b74743d2e38c331a1dbfe76a00205c85ac1f","blockNumber":"0x10","blockTimestamp":"0x692808ee","transactionHash":"0x64dcb9016eb59f7a2e48bfb0209f2730892edc805ac7c27642fe63aeb633218f","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000240000080000000000000000000000000020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000001100020000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x64dcb9016eb59f7a2e48bfb0209f2730892edc805ac7c27642fe63aeb633218f
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
null

blockHash            0xf97db74c0d847bc2f9359791a0a3eb81177005f05c366c3a98e171350b5090c1
blockNumber          17
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    126778874
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              48571
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x0000000000000000000000000165878a594ca255338adfa4d48449f69242eb8f"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xf97db74c0d847bc2f9359791a0a3eb81177005f05c366c3a98e171350b5090c1","blockNumber":"0x11","blockTimestamp":"0x692808ef","transactionHash":"0x6b8adb3a4e8806ed10faba8120ebbb86ce4c9214518402945f6dcb419e33c471","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000400000000200000000000000000000000000000000000000000000240000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000001100000000010000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x6b8adb3a4e8806ed10faba8120ebbb86ce4c9214518402945f6dcb419e33c471
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
[*] [s2] PREIMAGE      = super-secret-preimage
[*] [s2] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s2] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s2] Ready cho các scenario.

==================== [S2] Claim trong penalty window – penalty tuyến tính ====================

[S2] lock() từ TSS...

blockHash            0x3d0d6bbba9b129d5f9e93ff50ef60e1af9c6cd824e3a8235352f20af23ad6f24
blockNumber          18
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    110982830
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              265107
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x0000000000000000000000000165878a594ca255338adfa4d48449f69242eb8f"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x3d0d6bbba9b129d5f9e93ff50ef60e1af9c6cd824e3a8235352f20af23ad6f24","blockNumber":"0x12","blockTimestamp":"0x692808f0","transactionHash":"0x4116eedffd74c0f477dac4bad8af0a56a9b83da5785cebf89af1521ccb6dd513","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000008000000000000000240000080000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000002000000000000000000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x4116eedffd74c0f477dac4bad8af0a56a9b83da5785cebf89af1521ccb6dd513
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0165878A594ca255338adfa4d48449f69242Eb8F
[S2] Receiver confirmParticipation() – đặt cọc...

blockHash            0xf42ce03061bb0a5a5b75a682daf20bab947424e46f54f6c79ef27ddeca27db4a
blockNumber          19
contractAddress      
cumulativeGasUsed    83617
effectiveGasPrice    97355163
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83617
logs                 [{"address":"0x0165878a594ca255338adfa4d48449f69242eb8f","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xf42ce03061bb0a5a5b75a682daf20bab947424e46f54f6c79ef27ddeca27db4a","blockNumber":"0x13","blockTimestamp":"0x692808f1","transactionHash":"0x2420ed3c4ee9353c513009d49ec6d7afaa3468ebe4c7a2a4ffcbed18beeae1a0","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000040000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000200000000000000000000000002000000000000000000002000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x2420ed3c4ee9353c513009d49ec6d7afaa3468ebe4c7a2a4ffcbed18beeae1a0
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0165878A594ca255338adfa4d48449f69242Eb8F
[S2] evm_increaseTime 1300 (vào giữa penalty window)...
1300
"0x0"
[S2] ClaimWithSig trong penalty window...

blockHash            0x0edc23f074eaf0657159b64f8a5d1112cd1789c2a07e9a625271351785741806
blockNumber          21
contractAddress      
cumulativeGasUsed    115212
effectiveGasPrice    74596906
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              115212
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000165878a594ca255338adfa4d48449f69242eb8f","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x0edc23f074eaf0657159b64f8a5d1112cd1789c2a07e9a625271351785741806","blockNumber":"0x15","blockTimestamp":"0x69280e06","transactionHash":"0x53c6758441b2c1735f6813d3632ab634b8f6453d362c9c55162755fca871dcff","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x0165878a594ca255338adfa4d48449f69242eb8f","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x000000000000000000000000000000000000000000000000025bf6196bd10000","blockHash":"0x0edc23f074eaf0657159b64f8a5d1112cd1789c2a07e9a625271351785741806","blockNumber":"0x15","blockTimestamp":"0x69280e06","transactionHash":"0x53c6758441b2c1735f6813d3632ab634b8f6453d362c9c55162755fca871dcff","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000000400000000000000000000008000040000000000000000000000000000000000000000000000000000000000000000400000000000000001000000000000000000008000000000000000240000000000000000000000000000000000000000000000100000000000000000000000000000010000000040000000000000000002020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000006000000200000000000000000000000002000000000000001000002000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x53c6758441b2c1735f6813d3632ab634b8f6453d362c9c55162755fca871dcff
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0165878A594ca255338adfa4d48449f69242Eb8F
[S2] Balance receiver (token):
100000000000000000000 [1e20]
[S2] Balance TSS vs receiver (ETH) để xem penalty chia như thế nào:
100169964419898198136
99829972891997424366

==================== [s3] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s3] ADDR_TOKEN = 0x610178dA211FEF7D417bC0e6FeD39F05609AD788
[*] [s3] ADDR_HTLC  = 0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[*] [s3] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s3] ADDR_TSS      = 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
null
null

blockHash            0x232836155f15196de156c42397e90bb1771c8285f1ceb30cfaff36523cc3d6a6
blockNumber          26
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    39570327
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x232836155f15196de156c42397e90bb1771c8285f1ceb30cfaff36523cc3d6a6","blockNumber":"0x1a","blockTimestamp":"0x69280e0b","transactionHash":"0xe2d3b786e6140e41990d19fa5337a2442a5897a758fbb9ef0c54cc9b8f525e2e","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000080000000020000000000000000020000000000000000000800000000000000000040000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000100020000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0xe2d3b786e6140e41990d19fa5337a2442a5897a758fbb9ef0c54cc9b8f525e2e
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x610178dA211FEF7D417bC0e6FeD39F05609AD788
null

blockHash            0xa8106fb11e9fecf27ae3e67872e98bb9d055be3f3ab688eb988dadecb15f201c
blockNumber          27
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    34647661
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              48571
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x000000000000000000000000b7f8bc63bbcad18155201308c8f3540b07f84f5e"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xa8106fb11e9fecf27ae3e67872e98bb9d055be3f3ab688eb988dadecb15f201c","blockNumber":"0x1b","blockTimestamp":"0x69280e0c","transactionHash":"0x6f38941ee54542a16e35ce85d96478a7c20136d62ea4f2c97737493a1b3da506","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000002000400000000000000000000000000000000000000000000200000000000000000000000000002000000000000000000000080000000020000000000000000000000000000000000000000000000000000000040000400000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000010000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x6f38941ee54542a16e35ce85d96478a7c20136d62ea4f2c97737493a1b3da506
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x610178dA211FEF7D417bC0e6FeD39F05609AD788
[*] [s3] PREIMAGE      = super-secret-preimage
[*] [s3] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s3] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s3] Ready cho các scenario.

==================== [S3] Deposit đã confirm, không claim – refund sau timelock ====================

[S3] lock() từ TSS...

blockHash            0x7ae2de77039537a69084e39a4c974d4358486a0852629f91df58a626547d6dfd
blockNumber          28
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    30330728
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              265107
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x000000000000000000000000b7f8bc63bbcad18155201308c8f3540b07f84f5e"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x7ae2de77039537a69084e39a4c974d4358486a0852629f91df58a626547d6dfd","blockNumber":"0x1c","blockTimestamp":"0x69280e0d","transactionHash":"0x8b60da340c13bb96d898dab571da832b8a7fb42ac86fc14379eee70920f22ba6","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x0000000000000000000000000000000000000000000000000000000000000000000000000200040000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000080000000020000000000000000000000000000000000000000000000000000000040000410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x8b60da340c13bb96d898dab571da832b8a7fb42ac86fc14379eee70920f22ba6
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[S3] Receiver confirmParticipation() – đặt cọc...

blockHash            0x3bce60856d2bffcaba64d93e012cbcb0f32e4e58823b3c9a2998ee0770d142ad
blockNumber          29
contractAddress      
cumulativeGasUsed    83617
effectiveGasPrice    26606395
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83617
logs                 [{"address":"0xb7f8bc63bbcad18155201308c8f3540b07f84f5e","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x3bce60856d2bffcaba64d93e012cbcb0f32e4e58823b3c9a2998ee0770d142ad","blockNumber":"0x1d","blockTimestamp":"0x69280e0e","transactionHash":"0x7f19735aa7fa802976db98e05ff5c8673140263804406e3a4af9c26eed9731b4","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000100000000000000000000000000000000048000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000040000800000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000002000000000000000000002000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x7f19735aa7fa802976db98e05ff5c8673140263804406e3a4af9c26eed9731b4
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[S3] Receiver im lặng, không claim → mô phỏng griefing chậm.
[S3] Nhảy thời gian qua timelock (1800 + 1)...
3101
"0x0"
[S3] refund() từ phía TSS (sender)...

blockHash            0x42bd2ee3beffb97cdb332d33748179cf6434c1459559db4e0f8bf6022e4a6a6d
blockNumber          31
contractAddress      
cumulativeGasUsed    69408
effectiveGasPrice    20386745
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              69408
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000b7f8bc63bbcad18155201308c8f3540b07f84f5e","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x42bd2ee3beffb97cdb332d33748179cf6434c1459559db4e0f8bf6022e4a6a6d","blockNumber":"0x1f","blockTimestamp":"0x69281518","transactionHash":"0x2835ee472162e9d931f27cdbf26326485d5d1a5b1f807ffde049eb1f1d4c65c1","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xb7f8bc63bbcad18155201308c8f3540b07f84f5e","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x42bd2ee3beffb97cdb332d33748179cf6434c1459559db4e0f8bf6022e4a6a6d","blockNumber":"0x1f","blockTimestamp":"0x69281518","transactionHash":"0x2835ee472162e9d931f27cdbf26326485d5d1a5b1f807ffde049eb1f1d4c65c1","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x0000000010000000000000000000000000000000004800000000000000000020000000000200040000000000000000000000000000000000000000000000000000000000000000000000000a000000000000800000000080000000020000000000000000000000000000000000000000000000000000000040000410000000000000000000004000000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000100002000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x2835ee472162e9d931f27cdbf26326485d5d1a5b1f807ffde049eb1f1d4c65c1
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[S3] Balance TSS (token + ETH) sau refund:
1000000000000000000000 [1e21]
100999988861236952713

==================== [s4] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s4] ADDR_TOKEN = 0x9A676e781A523b5d0C0e43731313A708CB607508
[*] [s4] ADDR_HTLC  = 0x0B306BF915C4d645ff596e518fAf3F9669b97016
[*] [s4] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s4] ADDR_TSS      = 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
null
null

blockHash            0x2b6059e1ebae5ad814da3002660227a1d62f9bb30edbf9667fa6a7965b00f57c
blockNumber          35
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    12353767
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x2b6059e1ebae5ad814da3002660227a1d62f9bb30edbf9667fa6a7965b00f57c","blockNumber":"0x23","blockTimestamp":"0x6928151e","transactionHash":"0x4b5baf2f6100b8431cc71ea99d14d6298956f8a440b846ec3dc9b07b42d684c7","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000008000000000000000000000080000000000000000000000000020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000100020000000000000000000000000000000000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x4b5baf2f6100b8431cc71ea99d14d6298956f8a440b846ec3dc9b07b42d684c7
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x9A676e781A523b5d0C0e43731313A708CB607508
null

blockHash            0x057b9a25da45b61d62bbc7f1e869d28cad291f50f57554e0f406ea48396e650b
blockNumber          36
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    10816922
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              48571
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x0000000000000000000000000b306bf915c4d645ff596e518faf3f9669b97016"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x057b9a25da45b61d62bbc7f1e869d28cad291f50f57554e0f406ea48396e650b","blockNumber":"0x24","blockTimestamp":"0x6928151f","transactionHash":"0xfc5fb84f5b95d210b24cabf9db22180896c36cdc42247f184d6f1aa42bbf613c","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000080000000000000000008000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000200000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000010000000000000000000000400000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0xfc5fb84f5b95d210b24cabf9db22180896c36cdc42247f184d6f1aa42bbf613c
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x9A676e781A523b5d0C0e43731313A708CB607508
[*] [s4] PREIMAGE      = super-secret-preimage
[*] [s4] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s4] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s4] Ready cho các scenario.

==================== [S4] Không confirm deposit – refund sau depositWindow (penalty = 0) ====================

[S4] lock() từ TSS (KHÔNG confirmParticipation)...

blockHash            0x0309cc8ba2469fb2d8b5fdedd7f642a5d4c5fba6d9dfe3c37f4767c7c6f2ee4d
blockNumber          37
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    9469186
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              265107
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5","0x0000000000000000000000000b306bf915c4d645ff596e518faf3f9669b97016"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x0309cc8ba2469fb2d8b5fdedd7f642a5d4c5fba6d9dfe3c37f4767c7c6f2ee4d","blockNumber":"0x25","blockTimestamp":"0x69281520","transactionHash":"0x06e698d0b2e8db7c52b6285e9714b7e098bcc572ea1f332ee7396ecd57d07fae","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000080000000000000000008000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000008000000000000000000000080000000000000000000000000000000000000000200000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000100000000000000000000000000000000400000000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0x06e698d0b2e8db7c52b6285e9714b7e098bcc572ea1f332ee7396ecd57d07fae
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0B306BF915C4d645ff596e518fAf3F9669b97016
[S4] Nhảy thời gian qua depositWindow (600 + 1)...
3702
"0x0"
[S4] refund() từ TSS – không có penalty vì depositPaid = 0...

blockHash            0xf158da386cbda64dfcd3b1cacd4b5ecef9911618b6b38b5d3541921d3f4e9527
blockNumber          39
contractAddress      
cumulativeGasUsed    77847
effectiveGasPrice    7268151
from                 0xA48bBfBBa61dBE43E5f91A522ee075d44aD8dDA5
gasUsed              77847
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000b306bf915c4d645ff596e518faf3f9669b97016","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xf158da386cbda64dfcd3b1cacd4b5ecef9911618b6b38b5d3541921d3f4e9527","blockNumber":"0x27","blockTimestamp":"0x6928177a","transactionHash":"0xbb1a4e421fb076c36ad3bfabbf9355cc8f594ced4a00587286dc3d20f7cf4a2d","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x0b306bf915c4d645ff596e518faf3f9669b97016","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000a48bbfbba61dbe43e5f91a522ee075d44ad8dda5"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xf158da386cbda64dfcd3b1cacd4b5ecef9911618b6b38b5d3541921d3f4e9527","blockNumber":"0x27","blockTimestamp":"0x6928177a","transactionHash":"0xbb1a4e421fb076c36ad3bfabbf9355cc8f594ced4a00587286dc3d20f7cf4a2d","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000080001000000000000008000000000008000000000000000000200000000000000000000000000000001000000000000000000000000000000000000000000000000000000008000000000000000000000080000000000000000000000000000000000000000200000000000000000000000000000010000000000000000000004000000420000000000000000000008000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000100002000000000000000000000000000400010000000000000000000000000000800000
root                 
status               1 (success)
transactionHash      0xbb1a4e421fb076c36ad3bfabbf9355cc8f594ced4a00587286dc3d20f7cf4a2d
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0B306BF915C4d645ff596e518fAf3F9669b97016
[S4] Balance TSS (token) sau refund:
1000000000000000000000 [1e21]
[S4] Balance TSS (ETH) – chỉ trừ gas, không cộng thêm penalty:
99999996398460037739

==================== Hoàn tất PoC MP-HTLC-LGP – S1..S4 (mỗi scenario dùng 1 deploy riêng, cùng LOCK_ID & SIG) ====================
```
```bash
(base) PS D:\HTCLs\MP-HTLC-LGP\mpc-tss> go run main.go
2025/11/27 15:18:14 [P1] KEYGEN DONE
2025/11/27 15:18:14 [P2] KEYGEN DONE
2025/11/27 15:18:14 [P3] KEYGEN DONE
2025/11/27 15:18:14 ==> pubkey X=14515097176004613616365432393605161482576609917793417821685983681199916712007
Y=69882431770416377136287248104517428339923004181422508895235291481775589425848
TSS Ethereum Address = 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
Preimage: super-secret-preimage
lockId: 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
2025/11/27 15:18:15 [P1] SIGN DONE
2025/11/27 15:18:15 [P2] SIGN DONE
==> TSS signature:
r = ae375833dd75b404e132ff4329a4e57490ca9170251aae3e66b8d649c552bd49
s = 636cba42c5901d63d6ca1322ad509d5d096f8563262a5a93744a040ff7264dc3
v(recid) = [0]
ECDSA verify = true
ethSig(65) = 0xae375833dd75b404e132ff4329a4e57490ca9170251aae3e66b8d649c552bd49636cba42c5901d63d6ca1322ad509d5d096f8563262a5a93744a040ff7264dc300
DONE.
TSS signing time = 43.2640314s

[*] start anvil...
[*] TSS Ethereum Address = 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
[*] LOCK_ID             = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] SIG (ethSig(65))    = 0xae375833dd75b404e132ff4329a4e57490ca9170251aae3e66b8d649c552bd49636cba42c5901d63d6ca1322ad509d5d096f8563262a5a93744a040ff7264dc300

==================== [s1] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s1] ADDR_TOKEN = 0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] [s1] ADDR_HTLC  = 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[*] [s1] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s1] ADDR_TSS      = 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
null
null

blockHash            0xebe87d2d92e4936a784cbcb6777a36cc68c7ecc05c49e7e35c714b5f380b80a4
blockNumber          8
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    405684708
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xebe87d2d92e4936a784cbcb6777a36cc68c7ecc05c49e7e35c714b5f380b80a4","blockNumber":"0x8","blockTimestamp":"0x692809a9","transactionHash":"0x40b50473e43f0c1ce60eb61df742cb9938cf84ab6012e3064739b9640e5401c8","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000100000000000008000000000000000000000000000000000000000000000040020000000000000000000800000000000000000000000010020000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x40b50473e43f0c1ce60eb61df742cb9938cf84ab6012e3064739b9640e5401c8
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
null

blockHash            0xd35a6f866b940878219f583ef40a5b4d0740592802914013a72b3e360e955332
blockNumber          9
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    355216317
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              48571
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xd35a6f866b940878219f583ef40a5b4d0740592802914013a72b3e360e955332","blockNumber":"0x9","blockTimestamp":"0x692809ac","transactionHash":"0x586863d408198aa6e2cdb02011b6d8a34a6191b9c9820dd335d20c8a3f036335","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000200000000000000100000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000004020000000000000000000000000000000000000000000000000000000000000200000000020000000000000000000002000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x586863d408198aa6e2cdb02011b6d8a34a6191b9c9820dd335d20c8a3f036335
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[*] [s1] PREIMAGE      = super-secret-preimage
[*] [s1] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s1] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s1] Ready cho các scenario.

==================== [S1] Claim sớm – không penalty ====================

[S1] lock() từ TSS...

blockHash            0x7fa203b303d2c5839c610cd968333c9eaf1c0cb19bf885e490b4a043e2a6a542
blockNumber          10
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    310958055
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              265107
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x7fa203b303d2c5839c610cd968333c9eaf1c0cb19bf885e490b4a043e2a6a542","blockNumber":"0xa","blockTimestamp":"0x692809ad","transactionHash":"0xaa66b317babf386925108ba35760b9b29bee7289321baea83f84d9fa58c20f1c","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000100000000000008000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000014020000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xaa66b317babf386925108ba35760b9b29bee7289321baea83f84d9fa58c20f1c
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[S1] Receiver confirmParticipation() – đặt cọc...

blockHash            0x48737c82cc432a5e48d14d2a5c6a8f0b2dbd20d3fd504ebcdd292ea58dab03a5
blockNumber          11
contractAddress      
cumulativeGasUsed    83617
effectiveGasPrice    272775275
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83617
logs                 [{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x48737c82cc432a5e48d14d2a5c6a8f0b2dbd20d3fd504ebcdd292ea58dab03a5","blockNumber":"0xb","blockTimestamp":"0x692809ae","transactionHash":"0xfcde9e0d07635c0166851ff44fcd270b87a95984ec8d7248e44ce547c55f5a49","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0xfcde9e0d07635c0166851ff44fcd270b87a95984ec8d7248e44ce547c55f5a49
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[S1] ClaimWithSig ngay (không tăng thời gian, không bị penalty)...

blockHash            0xb5a8440e5dd977b3e82f348f3329ce9c7a4061771e3d4b4f3582bf6d3863afb4
blockNumber          12
contractAddress      
cumulativeGasUsed    101428
effectiveGasPrice    238868438
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              101428
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e7f1725e7734ce288f8367e1bb143e90bb3f0512","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xb5a8440e5dd977b3e82f348f3329ce9c7a4061771e3d4b4f3582bf6d3863afb4","blockNumber":"0xc","blockTimestamp":"0x692809af","transactionHash":"0x4905702394983f956f81c70c663fe67401bc19df6268db56e1fb3fb4422b649f","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xe7f1725e7734ce288f8367e1bb143e90bb3f0512","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xb5a8440e5dd977b3e82f348f3329ce9c7a4061771e3d4b4f3582bf6d3863afb4","blockNumber":"0xc","blockTimestamp":"0x692809af","transactionHash":"0x4905702394983f956f81c70c663fe67401bc19df6268db56e1fb3fb4422b649f","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000400400000000000000000000008000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000040000000000000000100000000000000000000000000000014000000000000000000000000002020000000000000000000000000000000000200000000000000000000000000000002000000000000000000000000000000000000000000000042000000200000000000001000000000002000000000000000000002000000000000000000000000000000000000000000000000800000000000000000
root                 
status               1 (success)
transactionHash      0x4905702394983f956f81c70c663fe67401bc19df6268db56e1fb3fb4422b649f
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
[S1] Balance receiver sau claim:
100000000000000000000 [1e20]
[S1] Balance TSS (ETH) sau scenario 1:
99999900309631180108

==================== [s2] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s2] ADDR_TOKEN = 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
[*] [s2] ADDR_HTLC  = 0x0165878A594ca255338adfa4d48449f69242Eb8F
[*] [s2] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s2] ADDR_TSS      = 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
null
null

blockHash            0x3bb1133523a81f0d2e94ce36e43d25ae893a7c7e2a7b533d388c171f3fa3c0e0
blockNumber          17
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    126692418
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x3bb1133523a81f0d2e94ce36e43d25ae893a7c7e2a7b533d388c171f3fa3c0e0","blockNumber":"0x11","blockTimestamp":"0x692809b4","transactionHash":"0x80134ac36d3e370c67ee022f98c71155cd8c397edd164fb611970dc9438fd50d","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000100000000000008000000000000000240000000000000000000000000000000020000000000000000000800000000000000000000000010020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000001000020000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x80134ac36d3e370c67ee022f98c71155cd8c397edd164fb611970dc9438fd50d
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
null

blockHash            0xdfbbddd9b221d5744182f756e757b08ae88f4e5bec83a30d2e8808bda0005794
blockNumber          18
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    110931503
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              48571
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x0000000000000000000000000165878a594ca255338adfa4d48449f69242eb8f"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0xdfbbddd9b221d5744182f756e757b08ae88f4e5bec83a30d2e8808bda0005794","blockNumber":"0x12","blockTimestamp":"0x692809b5","transactionHash":"0xf846b876956977a80dd3bff27edd66c5c3e6b7f15ca7ed159547d3e86cc2f675","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000040000000000400000000200000000000000100000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000001000000000010000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xf846b876956977a80dd3bff27edd66c5c3e6b7f15ca7ed159547d3e86cc2f675
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
[*] [s2] PREIMAGE      = super-secret-preimage
[*] [s2] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s2] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s2] Ready cho các scenario.

==================== [S2] Claim trong penalty window – penalty tuyến tính ====================

[S2] lock() từ TSS...

blockHash            0x0cf7872ee07d5c4acb0ecf6840b23ff31164f3f683927f9f06c69624e0dbcbe1
blockNumber          19
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    97109966
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              265107
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x0000000000000000000000000165878a594ca255338adfa4d48449f69242eb8f"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x0cf7872ee07d5c4acb0ecf6840b23ff31164f3f683927f9f06c69624e0dbcbe1","blockNumber":"0x13","blockTimestamp":"0x692809b6","transactionHash":"0xa2f93690a656e141c193a458b59ed8ec99a90f3a67ff02901ee64ad8a0a52d90","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000040000000000400000000000000000000000100000000000008000000000000000240000000000000000000000000000000000000000000000000000000000000000000000000000010020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000002000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xa2f93690a656e141c193a458b59ed8ec99a90f3a67ff02901ee64ad8a0a52d90
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0165878A594ca255338adfa4d48449f69242Eb8F
[S2] Receiver confirmParticipation() – đặt cọc...

blockHash            0x1eecd3f1babbd71ecca1e565b2e5a2a79060c7f7163797429749245592c28543
blockNumber          20
contractAddress      
cumulativeGasUsed    83617
effectiveGasPrice    85185759
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83617
logs                 [{"address":"0x0165878a594ca255338adfa4d48449f69242eb8f","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x1eecd3f1babbd71ecca1e565b2e5a2a79060c7f7163797429749245592c28543","blockNumber":"0x14","blockTimestamp":"0x692809b7","transactionHash":"0x0063a922f72aa01139a212bf080cfefd441a30a706ecdacc4925437b24cf30e5","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000100000000040000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000040000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000200000000000000000000000002000000000000000000002000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x0063a922f72aa01139a212bf080cfefd441a30a706ecdacc4925437b24cf30e5
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0165878A594ca255338adfa4d48449f69242Eb8F
[S2] evm_increaseTime 1300 (vào giữa penalty window)...
1300
"0x0"
[S2] ClaimWithSig trong penalty window...

blockHash            0x9e1687ef8e4e319e4ea73f32641af90b3a62adc75cab1177cd88ad068195407a
blockNumber          22
contractAddress      
cumulativeGasUsed    115200
effectiveGasPrice    65272286
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              115200
logs                 [{"address":"0x5fc8d32690cc91d4c39d9d3abcbd16989f875707","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000165878a594ca255338adfa4d48449f69242eb8f","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x9e1687ef8e4e319e4ea73f32641af90b3a62adc75cab1177cd88ad068195407a","blockNumber":"0x16","blockTimestamp":"0x69280ecc","transactionHash":"0xc74b51a39ef08ca1d1e5a1d8be7db6ed1773fe30c42de3dacbfeec02b1daaae4","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x0165878a594ca255338adfa4d48449f69242eb8f","topics":["0x6cc5cfa00da40b945714bf76752e8b0512ceadb6da5356f33f7022022aabb984","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x000000000000000000000000000000000000000000000000025bf6196bd10000","blockHash":"0x9e1687ef8e4e319e4ea73f32641af90b3a62adc75cab1177cd88ad068195407a","blockNumber":"0x16","blockTimestamp":"0x69280ecc","transactionHash":"0xc74b51a39ef08ca1d1e5a1d8be7db6ed1773fe30c42de3dacbfeec02b1daaae4","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000000400000000000000000000008000040000000000000000000000000000000000000000000000000000000000000000400000000000000001000000000000000000008000000000000000240000000000000000000000000000000000000000000000100000000000000000000000000000010000000040000000000000000002020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000006000000200000000000000000000000002000000000000001000002000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xc74b51a39ef08ca1d1e5a1d8be7db6ed1773fe30c42de3dacbfeec02b1daaae4
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0165878A594ca255338adfa4d48449f69242Eb8F
[S2] Balance receiver (token):
100000000000000000000 [1e20]
[S2] Balance TSS vs receiver (ETH) để xem penalty chia như thế nào:
100169968867414211425
99829976281283524559

==================== [s3] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s3] ADDR_TOKEN = 0x610178dA211FEF7D417bC0e6FeD39F05609AD788
[*] [s3] ADDR_HTLC  = 0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[*] [s3] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s3] ADDR_TSS      = 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
null
null

blockHash            0x9bef8a2a4fa689a4340964028b7b0c875d259217e64b189fcdd1262970d65026
blockNumber          26
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    39570318
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x9bef8a2a4fa689a4340964028b7b0c875d259217e64b189fcdd1262970d65026","blockNumber":"0x1a","blockTimestamp":"0x69280ed0","transactionHash":"0xa6256838cb4f499e4e5af37c7508652673d781e8dcc924c60825da5a7d0db0a4","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000040000000000000000000000000000000000100000000000008000000000000000000000000000000020000000000000000020000000000000000000800000000000000000040000010020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xa6256838cb4f499e4e5af37c7508652673d781e8dcc924c60825da5a7d0db0a4
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x610178dA211FEF7D417bC0e6FeD39F05609AD788
null

blockHash            0x2a7d6b773abf8558620d48c9deb57e6a2a25163c4059c76ebaf12205b08e6fc2
blockNumber          27
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    34647653
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              48571
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x000000000000000000000000b7f8bc63bbcad18155201308c8f3540b07f84f5e"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x2a7d6b773abf8558620d48c9deb57e6a2a25163c4059c76ebaf12205b08e6fc2","blockNumber":"0x1b","blockTimestamp":"0x69280ed1","transactionHash":"0x84b034999f73f10cf0d72b3795955c01f5e0169cceb0dae4d744297a61e91753","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000002000400000000000000000000000040000000000000000000200000000000000100000000000002000000000000000000000000000000020000000000000000000000000000000000000000000000000000000040000400020000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x84b034999f73f10cf0d72b3795955c01f5e0169cceb0dae4d744297a61e91753
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x610178dA211FEF7D417bC0e6FeD39F05609AD788
[*] [s3] PREIMAGE      = super-secret-preimage
[*] [s3] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s3] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s3] Ready cho các scenario.

==================== [S3] Deposit đã confirm, không claim – refund sau timelock ====================

[S3] lock() từ TSS...

blockHash            0xdab6f2df0ba4d74e505645fa1f44cd2da1291ee7a6dcd96d645138ae2cf3a3c2
blockNumber          28
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    30330721
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              265107
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x000000000000000000000000b7f8bc63bbcad18155201308c8f3540b07f84f5e"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xdab6f2df0ba4d74e505645fa1f44cd2da1291ee7a6dcd96d645138ae2cf3a3c2","blockNumber":"0x1c","blockTimestamp":"0x69280ed2","transactionHash":"0xe101ba0c9b027cea247575184c2da7bf0e416d1d247f14ebd53d9b35ba3ec5d6","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x0000000000000000000000000000000000000000000000000000000000000000000000000200040000000000000000000000004000000000000000000000000000000000010000000000000a000000000000000000000000000000020000000000000000000000000000000000000000000000000000000040000410020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xe101ba0c9b027cea247575184c2da7bf0e416d1d247f14ebd53d9b35ba3ec5d6
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[S3] Receiver confirmParticipation() – đặt cọc...

blockHash            0x5b61f15cff1390373985f35a81181078c5b7f220864cada50ce3623028bd29db
blockNumber          29
contractAddress      
cumulativeGasUsed    83617
effectiveGasPrice    26606389
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              83617
logs                 [{"address":"0xb7f8bc63bbcad18155201308c8f3540b07f84f5e","topics":["0x9d39974c480d889b2e46ed1adc6e673ef0ea9f11554437438b05a17cecbde95e","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x5b61f15cff1390373985f35a81181078c5b7f220864cada50ce3623028bd29db","blockNumber":"0x1d","blockTimestamp":"0x69280ed3","transactionHash":"0x6aae2cb428feeb5c6dba1c8b31e5b7d2b379a35becd22868072361d9bbbad61d","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000100000000000000000000000000000000048000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000040000800000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000020000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000002000000000000000000002000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x6aae2cb428feeb5c6dba1c8b31e5b7d2b379a35becd22868072361d9bbbad61d
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[S3] Receiver im lặng, không claim → mô phỏng griefing chậm.
[S3] Nhảy thời gian qua timelock (1800 + 1)...
3101
"0x0"
[S3] refund() từ phía TSS (sender)...

blockHash            0x905503929228748aaecfb4fd59e87a0d4194b33ba66a2a12485982fafd80c388
blockNumber          31
contractAddress      
cumulativeGasUsed    69408
effectiveGasPrice    20386740
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              69408
logs                 [{"address":"0x610178da211fef7d417bc0e6fed39f05609ad788","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000b7f8bc63bbcad18155201308c8f3540b07f84f5e","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x905503929228748aaecfb4fd59e87a0d4194b33ba66a2a12485982fafd80c388","blockNumber":"0x1f","blockTimestamp":"0x692815dd","transactionHash":"0x94a61abf002913c5e9fbe61939949488120d51d935e3f3a57053fbb97c9c70b5","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xb7f8bc63bbcad18155201308c8f3540b07f84f5e","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x0000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x905503929228748aaecfb4fd59e87a0d4194b33ba66a2a12485982fafd80c388","blockNumber":"0x1f","blockTimestamp":"0x692815dd","transactionHash":"0x94a61abf002913c5e9fbe61939949488120d51d935e3f3a57053fbb97c9c70b5","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x0000000010000000000000000000000000000000004800000000000000000020000000000200040000000000000000000000004000000000000000000000000000000000010000000000000a000000000000800000000000000000020000000000000000000000000000000000000000000000000000000040000410020000000000000000004000000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x94a61abf002913c5e9fbe61939949488120d51d935e3f3a57053fbb97c9c70b5
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e
[S3] Balance TSS (token + ETH) sau refund:
1000000000000000000000 [1e21]
100999988861239544070

==================== [s4] Deploy MockToken + HTLC-LGP bằng forge script ====================

[*] [s4] ADDR_TOKEN = 0x9A676e781A523b5d0C0e43731313A708CB607508
[*] [s4] ADDR_HTLC  = 0x0B306BF915C4d645ff596e518fAf3F9669b97016
[*] [s4] ADDR_RECEIVER = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
[*] [s4] ADDR_TSS      = 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
null
null

blockHash            0x47049bfec02a98d7816a1d05257a33282508bbc2dc2340f0557ef56e695a193e
blockNumber          35
contractAddress      
cumulativeGasUsed    71641
effectiveGasPrice    12353765
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              71641
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x47049bfec02a98d7816a1d05257a33282508bbc2dc2340f0557ef56e695a193e","blockNumber":"0x23","blockTimestamp":"0x692815e1","transactionHash":"0x319f6c0f6523140e93a0891ce440d1a8102a648c6a08bc88f3e4616315f683ea","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000001000000040000000000000000000000000000000000100000000000008000000000000000000000000000000000000000000000000020000000000000000000800000000000000000000000010020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x319f6c0f6523140e93a0891ce440d1a8102a648c6a08bc88f3e4616315f683ea
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x9A676e781A523b5d0C0e43731313A708CB607508
null

blockHash            0x4e3c70067628aa8db5cf1c93a8be23bec1748c980ea404370cd208f722f7b822
blockNumber          36
contractAddress      
cumulativeGasUsed    48571
effectiveGasPrice    10816920
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              48571
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x0000000000000000000000000b306bf915c4d645ff596e518faf3f9669b97016"],"data":"0x00000000000000000000000000000000000000000000003635c9adc5dea00000","blockHash":"0x4e3c70067628aa8db5cf1c93a8be23bec1748c980ea404370cd208f722f7b822","blockNumber":"0x24","blockTimestamp":"0x692815e2","transactionHash":"0x608b0330ede32c026a0e0e2bd65baf08c067b9ef91c3fa2431c4022bdffaac6c","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000080000000000000000008000000000000000000000000000000000000000000000000000000000000001000000040000000000000000000200000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000400000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x608b0330ede32c026a0e0e2bd65baf08c067b9ef91c3fa2431c4022bdffaac6c
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x9A676e781A523b5d0C0e43731313A708CB607508
[*] [s4] PREIMAGE      = super-secret-preimage
[*] [s4] PREIMAGE_HEX  = 0x73757065722d7365637265742d707265696d616765
[*] [s4] LOCK_ID       = 0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8
[*] [s4] Ready cho các scenario.

==================== [S4] Không confirm deposit – refund sau depositWindow (penalty = 0) ====================

[S4] lock() từ TSS (KHÔNG confirmParticipation)...

blockHash            0xb4d5acc618213bb707c0379dffcea543bc90faf4e9d91b2e43a22c35fbfd2fea
blockNumber          37
contractAddress      
cumulativeGasUsed    265107
effectiveGasPrice    9469184
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              265107
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72","0x0000000000000000000000000b306bf915c4d645ff596e518faf3f9669b97016"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xb4d5acc618213bb707c0379dffcea543bc90faf4e9d91b2e43a22c35fbfd2fea","blockNumber":"0x25","blockTimestamp":"0x692815e3","transactionHash":"0x052f4718871043a7a4f9ede4da2df9deaf5e5731653b3a63d66048dabe2eaf71","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000080000000000000000008000000000000000000000000000000000000000000000000000000000000001000000040000000000000000000000000000000000100000000000008000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000010020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0x052f4718871043a7a4f9ede4da2df9deaf5e5731653b3a63d66048dabe2eaf71
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0B306BF915C4d645ff596e518fAf3F9669b97016
[S4] Nhảy thời gian qua depositWindow (600 + 1)...
3702
"0x0"
[S4] refund() từ TSS – không có penalty vì depositPaid = 0...

blockHash            0xca582bed1cb4b5f3b9c33f1918ce7939484c7ba4ccda53cfa0f963aed91d19f5
blockNumber          39
contractAddress      
cumulativeGasUsed    77847
effectiveGasPrice    7268150
from                 0x8601a60A54292b79Bd3Fe6AAfa3B4FE59dad6B72
gasUsed              77847
logs                 [{"address":"0x9a676e781a523b5d0c0e43731313a708cb607508","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000b306bf915c4d645ff596e518faf3f9669b97016","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xca582bed1cb4b5f3b9c33f1918ce7939484c7ba4ccda53cfa0f963aed91d19f5","blockNumber":"0x27","blockTimestamp":"0x6928183d","transactionHash":"0xfd703056bbaff81d294a7085904f257eabbb4747adc39975a4aa50661d336e23","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x0b306bf915c4d645ff596e518faf3f9669b97016","topics":["0x05f90198a72764b108e8955af3ca29c06f67547adf4dc68cfb82c62f9483a126","0x65f0239b7d0b86de4013929ffe5e4cbe2dca4cb95c6a5743d2ccacb01746eda8","0x0000000000000000000000008601a60a54292b79bd3fe6aafa3b4fe59dad6b72"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0xca582bed1cb4b5f3b9c33f1918ce7939484c7ba4ccda53cfa0f963aed91d19f5","blockNumber":"0x27","blockTimestamp":"0x6928183d","transactionHash":"0xfd703056bbaff81d294a7085904f257eabbb4747adc39975a4aa50661d336e23","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000080001000000000000008000000000008000000000000000000200000000000000000000000000000001000000040000000000000000000000000000000000100000000000008000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000010020000000000000000004000000420000000000000000000008000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000002000000000000000000000000000400010000000000000000000000000000000000
root                 
status               1 (success)
transactionHash      0xfd703056bbaff81d294a7085904f257eabbb4747adc39975a4aa50661d336e23
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed          
to                   0x0B306BF915C4d645ff596e518fAf3F9669b97016
[S4] Balance TSS (token) sau refund:
1000000000000000000000 [1e21]
[S4] Balance TSS (ETH) – chỉ trừ gas, không cộng thêm penalty:
99999996398460742942

==================== Hoàn tất PoC MP-HTLC-LGP – S1..S4 (mỗi scenario dùng 1 deploy riêng, cùng LOCK_ID & SIG) ====================
```